-------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/
> Injury-Classification/Model Output + Summaries/all/MR/log 10-22/l
> og_part_year.txt
  log type:  text
 opened on:  22 Oct 2016, 12:15:08
. }

. 
. if "`mine_sample'" == "big" { 
.         local directory "C:/Users/jbodson/Dropbox (Stanford Law S
> chool)/R-code/Injury-Classification/Model Output + Summaries/big/
> `version'/`injury_type'/estout `date'/"
.         capture log close
.         log using "C:/Users/jbodson/Dropbox (Stanford Law School)
> /R-code/Injury-Classification/Model Output + Summaries/big/`versi
> on'/`injury_type'/log `date'/log_`violation_level'_`log_time'.txt
> ", text
. }       

.         
. if "`mine_sample'" == "bad" | "`mine_sample'" == "big_bad" { 
.         local directory "C:/Users/jbodson/Dropbox (Stanford Law S
> chool)/R-code/Injury-Classification/Model Output + Summaries/`min
> e_sample'/`badness'/`version'/`injury_type'/estout `date'/"
.         capture log close
.         log using "C:/Users/jbodson/Dropbox (Stanford Law School)
> /R-code/Injury-Classification/Model Output + Summaries/`mine_samp
> le'/`/`badness'/`version'/`injury_type'/log `date'/log_`violation
> _level'_`log_time'.txt", text
. }

. 
. *****************************************************************
> ***************
. *****************************************************************
> ***************
. // DATA SET-UP
. 
. // format variables
. if "`injury_type'" == "MR" {
.         rename MR dv
.         rename MR_indicator dv_indicator
.         local injury_label "MR"
.         local relevant_parts "47 48 71 72 75 77"
. }

. 
. if "`injury_type'" == "PS" {
.         rename PS dv
.         rename PS_indicator dv_indicator
.         local injury_label "PS"
.         local relevant_parts "48 75"
. }

. 
. if "`violation_level'" == "part" {
.         local violation_level_label "P"
. }

. 
. if "`violation_level'" == "subpart" {
.         local violation_level_label "SP"
. }

. 
. gen sample_pp = quarter >= 2007 // flag obs after or equal to 200
> 7 to use in penlaty points analyses (assessments changed for the 
> last time in 2007)

. 
. tostring quarter, replace
quarter was double now str7

. encode quarter, gen(quart)

. drop quarter year

. rename quart time

. 
. local time_label "Q" // will be overwritten if unit_of_analysis i
> s year_sum or year_avg

. 
. if "`unit_of_analysis'" == "year_sum" { // collapse to mine years
>  - sums 
.         local time_label "Y"
.         
.         // count number of complete quarters per year
.         decode time, gen(year)
.         replace year = regexs(0) if(regexm(year, "^[0-9][0-9][0-9
> ][0-9]"))
(22,385 real changes made)
.         gen marker = 1
.         bysort mineid year: egen num_quarts = sum(marker)
.                 /*tab num_quarts
>                          num_quarts |      Freq.     Percent     
>    Cum.
>                         ------------+----------------------------
> -------
>                                           1 |      1,100        3
> .63        3.63
>                                           2 |      1,666        5
> .50        9.13
>                                           3 |      2,511        8
> .29       17.42
>                                           4 |     25,012       82
> .58      100.00
>                         ------------+----------------------------
> -------
>                                   Total |     30,289      100.00 
> - Sarah 9/21/2016 @ 10:54 PM */
.         drop if num_quarts < 4
(5,277 observations deleted)
.         
.         // collapse to the mine-year 
.         collapse (sum) p* sp* onsite_insp_hours hours dv* (firstn
> m) state sample_pp union longwall, by(mineid year)
.         rename year time
.         encode time, gen(time2)
.         drop time
.         rename time2 time
.         bys mineid: gen mine_time = _n
.         
.         pause "complete: year_sum collapse"
. }

. 
. if "`unit_of_analysis'" == "year_avg" { // collapse on mine years - averages
.         local time_label "Y"
.         decode time, gen(year)
.         replace year = regexs(0) if(regexm(year, "^[0-9][0-9][0-9][0-9]"))
.         pause "collapsing to mine-year"
.         collapse (mean) p* sp* onsite_insp_hours hours dv* (firstnm) state sample_pp union longwall, by(mineid year)
.         rename year time
.         encode time, gen(time2)
.         drop time
.         rename time2 time
.         bys mineid: gen mine_time = _n
.         
.         pause "complete: year_avg collapse"
. }

. 
. drop dv_indicator

. gen dv_binary = 0 if dv == 0
(3,455 missing values generated)

. replace dv_binary = 1 if dv != 0
(3,455 real changes made)

. rename dv_binary dv_indicator

.         
. gen lnhours = log(hours)

. 
. pause "complete: data formatting"

. 
. // group variables
. local covariates "mine_time onsite_insp_hours longwall"

. 
. if "`union_status'" == "on" {
.         local covariates "`covariates' union"
. }

. 
. *** lag 0 ***
. if "`violation_level'" == "part" {
. 
.         foreach x in `relevant_parts' {
  2.                 foreach var of varlist p`x' {
  3.                         local count_vars `count_vars' `var'
  4.                 }
  5.         }
.         noi di "`count_vars'"
p47 p48 p71 p72 p75 p77
. 
.         foreach var of varlist p*ss {
  2.                 local ss_vars `ss_vars' `var'
  3.         }
.         noi di "`ss_vars'"
p47_ss p48_ss p71_ss p72_ss p75_ss p77_ss
. 
.         foreach var of varlist p*pp {
  2.                 local pp_vars `pp_vars' `var'
  3.         }
.         noi di "`pp_vars'"
p47_pp p48_pp p71_pp p72_pp p75_pp p77_pp
.         
.         pause "complete: variable groups - part no lag"
. }

. 
. if "`violation_level'" == "subpart" {
. 
.         foreach x in 1 2 3 4 5 6 7 8 9 0 {
  2.                 foreach var of varlist sp*`x' {
  3.                         local count_vars `count_vars' `var'
  4.                 }
  5.         }
.         noi di "`count_vars'"
. 
.         foreach var of varlist sp*ss {
  2.                 local ss_vars `ss_vars' `var'
  3.         }
.         noi di "`ss_vars'"
. 
.         foreach var of varlist sp*pp {
  2.                 local pp_vars `pp_vars' `var'
  3.         }
.         noi di "`pp_vars'"
.         
.         pause "complete: variable groups - subpart no lag"
. }

. 
. *** lag 1 ***
. if "`violation_level'" == "part" {
. 
.         foreach x in `relevant_parts' {
  2.                 foreach var of varlist p`x'_1lag  {
  3.                         local count_lag_1_vars `count_lag_1_vars' `var'
  4.                 }
  5.         }
.         noi di "`count_lag_1_vars'"
p47_1lag p48_1lag p71_1lag p72_1lag p75_1lag p77_1lag
. 
.         foreach var of varlist p*ss_1lag  {
  2.                 local ss_lag_1_vars `ss_lag_1_vars' `var'
  3.         }
.         noi di "`ss_lag_1_vars'"
p47_ss_1lag p48_ss_1lag p71_ss_1lag p72_ss_1lag p75_ss_1lag p77_ss_1lag
. 
.         foreach var of varlist p*pp_1lag  {
  2.                 local pp_lag_1_vars `pp_lag_1_vars' `var'
  3.         }
.         noi di "`pp_lag_1_vars'"
p47_pp_1lag p48_pp_1lag p71_pp_1lag p72_pp_1lag p75_pp_1lag p77_pp_1lag
.         
.         pause "complete: variable groups - part lag 1"
. }

. 
. if "`violation_level'" == "subpart" {
. 
.         foreach x in 1 2 3 4 5 6 7 8 9 0 {
  2.                 foreach var of varlist sp*`x'_1lag  {
  3.                         local count_lag_1_vars `count_lag_1_vars' `var'
  4.                 }
  5.         }
.         noi di "`count_lag_1_vars'"
. 
.         foreach var of varlist sp*ss_1lag  {
  2.                 local ss_lag_1_vars `ss_lag_1_vars' `var'
  3.         }
.         noi di "`ss_lag_1_vars'"
. 
. 
.         foreach var of varlist sp*pp_1lag  {
  2.                 local pp_lag_1_vars `pp_lag_1_vars' `var'
  3.         }
.         noi di "`pp_lag_1_vars'"
. 
.         pause "complete: variable groups - subpart lag 1"
. } 

. 
. *** lag 4 ***
. if "`violation_level'" == "part" {
.         
.         foreach x in `relevant_parts' {
  2.                 foreach var of varlist p`x'_c_4lag  {
  3.                         local count_lag_4_vars `count_lag_4_vars' `var'
  4.                 }
  5.         }
.         noi di "`count_lag_4_vars'"
p47_c_4lag p48_c_4lag p71_c_4lag p72_c_4lag p75_c_4lag p77_c_4lag
. 
.         foreach var of varlist p*ss_c_4lag {
  2.                 local ss_lag_4_vars `ss_lag_4_vars' `var'
  3.         }
.         noi di "`ss_lag_4_vars'"
p47_ss_c_4lag p48_ss_c_4lag p71_ss_c_4lag p72_ss_c_4lag p75_ss_c_4lag p77_ss_c_4lag
. 
.         foreach var of varlist p*pp_c_4lag {
  2.                 local pp_lag_4_vars `pp_lag_4_vars' `var'
  3.         }
.         noi di "`pp_lag_4_vars'"
p47_pp_c_4lag p48_pp_c_4lag p71_pp_c_4lag p72_pp_c_4lag p75_pp_c_4lag p77_pp_c_4lag
. 
.         pause "complete: variable groups - part lag 4"
. }

. 
. if "`violation_level'" == "subpart" {
. 
.         foreach x in 1 2 3 4 5 6 7 8 9 0 {
  2.                 foreach var of varlist sp*`x'_c_4lag  {
  3.                         local count_lag_4_vars `count_lag_4_vars' `var'
  4.                 }
  5.         }
.         noi di "`count_lag_4_vars'"
. 
.         foreach var of varlist sp*ss_c_4lag {
  2.                 local ss_lag_4_vars `ss_lag_4_vars' `var'
  3.         }
.         noi di "`ss_lag_4_vars'"
. 
.         foreach var of varlist sp*pp_c_4lag {
  2.                 local pp_lag_4_vars `pp_lag_4_vars' `var'
  3.         }
.         noi di "`pp_lag_4_vars'"
. 
.         pause "complete: variable groups - subpart lag 4"
. }

. 
. *** lag all ***
. if "`violation_level'" == "part" {
. 
.         foreach x in `relevant_parts' {
  2.                 foreach var of varlist p`x'_c_lag_all  {
  3.                         local count_lag_all_vars `count_lag_all_vars' `var'
  4.                 }
  5.         }
.         noi di "`count_lag_all_vars'"
p47_c_lag_all p48_c_lag_all p71_c_lag_all p72_c_lag_all p75_c_lag_all p77_c_lag_all
. 
.         foreach var of varlist p*ss_c_lag_all {
  2.                 local ss_lag_all_vars `ss_lag_all_vars' `var'
  3.         }
.         noi di "`ss_lag_all_vars'"
p47_ss_c_lag_all p48_ss_c_lag_all p71_ss_c_lag_all p72_ss_c_lag_all p75_ss_c_lag_all p77_ss_c_lag_all
. 
.         foreach var of varlist p*pp_c_lag_all {
  2.                 local pp_lag_all_vars `pp_lag_all_vars' `var'
  3.         }
.         noi di "`pp_lag_all_vars'"
p47_pp_c_lag_all p48_pp_c_lag_all p71_pp_c_lag_all p72_pp_c_lag_all p75_pp_c_lag_all p77_pp_c_lag_all
. 
.         pause "complete: variable groups - part lag all"
. }

. 
. if "`violation_level'" == "subpart" {
. 
.         foreach x in 1 2 3 4 5 6 7 8 9 0 {
  2.                 foreach var of varlist sp*`x'_c_lag_all  {
  3.                         local count_lag_all_vars `count_lag_all_vars' `var'
  4.                 }
  5.         }
.         noi di "`count_lag_all_vars'"
.         
.         foreach var of varlist sp*ss_c_lag_all {
  2.                 local ss_lag_all_vars `ss_lag_all_vars' `var'
  3.         }
.         noi di "`ss_lag_all_vars'"
.         
.         foreach var of varlist sp*pp_c_lag_all {
  2.                 local pp_lag_all_vars `pp_lag_all_vars' `var'
  3.         }
.         noi di "`pp_lag_all_vars'"
. 
.         pause "complete: variable groups - subpart lag all"
. }

. 
. ********************************************************************************
. *******************************************************************************
. // DATA OVERVIEW
. 
. // outcome variables
. summ dv

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          dv |      6,253    1.881017    3.268911          0         37

. 
. pause "next"

. 
. tab dv_indicator

dv_indicato |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      2,798       44.75       44.75
          1 |      3,455       55.25      100.00
------------+-----------------------------------
      Total |      6,253      100.00

.           
. pause "next"

. 
. if "`violation_level'" == "part" {
.         summ `count_vars' `ss_vars' `pp_vars'

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         p47 |      6,253    .0308652    .2208875          0          4
         p48 |      6,253     .318727    1.248145          0         69
         p71 |      6,253    .0316648    .2084777          0          6
         p72 |      6,253    .0686071    .3349849          0          5
         p75 |      6,253    61.19367    74.81325          0        841
-------------+---------------------------------------------------------
         p77 |      6,253    1.407005    2.738063          0         45
      p47_ss |      6,253    .0043179    .0768079          0          3
      p48_ss |      6,253    .0702063    .3739304          0          7
      p71_ss |      6,253    .0059172     .078759          0          2
      p72_ss |      6,253     .006237    .0846096          0          2
-------------+---------------------------------------------------------
      p75_ss |      6,253    16.74796    22.09002          0        252
      p77_ss |      6,253    .2246921    .6935527          0         15
      p47_pp |      6,253    1.627379    13.44875          0        293
      p48_pp |      6,253    13.45146    66.03334          0       3787
      p71_pp |      6,253    1.474172    11.90392          0        422
-------------+---------------------------------------------------------
      p72_pp |      6,253    2.984967    16.88058          0        285
      p75_pp |      6,253    3162.992    5262.654          0      60818
      p77_pp |      6,253    55.24308    137.2511          0       2195
.         
.         pause "next"
.         
.         summ `count_lag_1_vars' `ss_lag_1_vars' `pp_lag_1_vars'

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
    p47_1lag |      6,253    .0319846    .2323773          0          5
    p48_1lag |      6,253    .3144091    1.259505          0         69
    p71_1lag |      6,253     .029266    .1908178          0          4
    p72_1lag |      6,253    .0671678    .3321611          0          5
    p75_1lag |      6,253    59.77707    74.55003          0        926
-------------+---------------------------------------------------------
    p77_1lag |      6,253    1.399488    2.762226          0         54
 p47_ss_1lag |      6,253    .0043179    .0788629          0          3
 p48_ss_1lag |      6,253    .0705261    .3831667          0          9
 p71_ss_1lag |      6,253    .0055973    .0767253          0          2
 p72_ss_1lag |      6,253     .006237    .0864794          0          2
-------------+---------------------------------------------------------
 p75_ss_1lag |      6,253    16.35983    21.88199          0        226
 p77_ss_1lag |      6,253    .2256517    .6950844          0         12
 p47_pp_1lag |      6,253    1.659683     14.1797          0        362
 p48_pp_1lag |      6,253    13.25172    66.63073          0       3787
 p71_pp_1lag |      6,253    1.321925    10.28432          0        302
-------------+---------------------------------------------------------
 p72_pp_1lag |      6,253    2.910123    16.75465          0        285
 p75_pp_1lag |      6,253    3075.187    5239.899          0      71114
 p77_pp_1lag |      6,253    54.73533    139.7695          0       3198
.         
.         pause "next"
.         
.         summ `count_lag_4_vars' `ss_lag_4_vars' `pp_lag_4_vars'

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  p47_c_4lag |      6,253     .116744    .7325248          0         17
  p48_c_4lag |      6,253    1.159923    3.899655          0        143
  p71_c_4lag |      6,253    .1066688    .6051934          0          8
  p72_c_4lag |      6,253     .260355     1.15941          0         22
  p75_c_4lag |      6,253    224.6303    295.5619          0       3645
-------------+---------------------------------------------------------
  p77_c_4lag |      6,253    5.116584    9.941045          0        170
p47_ss_c_4~g |      6,253    .0158324    .2330061          0          9
p48_ss_c_4~g |      6,253    .2534783    1.196286          0         30
p71_ss_c_4~g |      6,253    .0212698    .2465926          0          6
p72_ss_c_4~g |      6,253    .0243083    .2923379          0          7
-------------+---------------------------------------------------------
p75_ss_c_4~g |      6,253    60.97217    84.82983          0        941
p77_ss_c_4~g |      6,253    .7925796    2.268451          0         38
p47_pp_c_4~g |      6,253    6.123781    45.19252          0       1226
p48_pp_c_4~g |      6,253    49.52407    207.2291          0       7851
p71_pp_c_4~g |      6,253     4.93795    33.17018          0        604
-------------+---------------------------------------------------------
p72_pp_c_4~g |      6,253    11.43739    58.23657          0       1098
p75_pp_c_4~g |      6,253    11787.54     20580.5          0     280327
p77_pp_c_4~g |      6,253    204.1308    507.4484          0      10036
.         
.         pause "next"
.         
.         summ `count_lag_all_vars' `ss_lag_all_vars' `pp_lag_all_vars'

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
p47_c_lag_~l |      6,253    .3617464    1.865509          0         36
p48_c_lag_~l |      6,253    4.830641    13.17843          0        288
p71_c_lag_~l |      6,253    .4850472    2.111869          0         36
p72_c_lag_~l |      6,253     .966736    3.909793          0         72
p75_c_lag_~l |      6,253    990.6915    2288.909          0      27670
-------------+---------------------------------------------------------
p77_c_lag_~l |      6,253    26.25172    70.72726          0        858
p47_ss_c_l~l |      6,253    .0449384    .4457757          0          8
p48_ss_c_l~l |      6,253    1.384296    4.759533          0         52
p71_ss_c_l~l |      6,253    .1050696    .6451216          0          8
p72_ss_c_l~l |      6,253    .1237806     1.08147          0         20
-------------+---------------------------------------------------------
p75_ss_c_l~l |      6,253    282.7846    639.4148          0       7503
p77_ss_c_l~l |      6,253    4.085879     10.9226          0        104
p47_pp_c_l~l |      6,253    14.92803    89.47016          0       1640
p48_pp_c_l~l |      6,253    170.4297    577.2885          0      15716
p71_pp_c_l~l |      6,253    18.09899    93.01788          0       1713
-------------+---------------------------------------------------------
p72_pp_c_l~l |      6,253    37.30273    182.9094          0       3984
p75_pp_c_l~l |      6,253    40611.28    109100.8          0    1515903
p77_pp_c_l~l |      6,253    760.4978    2434.551          0      33461
. }

. 
. pause "complete: data overview"

. 
. *******************************************************************************/
. /*******************************************************************************
> // MODEL LABEL KEY
> 
> Model X.Y.Z
>   X
>     C: response variable is count of injuries
>     B: response variable is binary of injuries
>   Y
>     V: predictors are number of violations
>     SSV: predictors are number of significant and substantial violations
>     PP: predictors are number of penalty points
>   Z
>     1: inj_t ~ viol_t
>     2: inj_t ~ viol_(t_-1)
>     3: inj_t ~ viol_(annual sum pre_t)
>     4: inj_t ~ viol_(sum since study period) 
> 
> *******************************************************************************/
. ********************************************************************************
. // NULL MODELS (V & SSV)
. 
. // count outcome (V & SSV)
. /*
> glm dv, family(poisson) link(log) vce(cl mineid) exposure(hours) eform
>         
> pause "next"    
>         
> quietly poisson dv, vce(cl mineid) exposure(hours) irr
> estat gof
> 
> pause "next"
>         
> glm dv, family(nbinomial) link(log) vce(cl mineid) exposure(hours) eform
> 
> pause "next"
> */
. 
. nbreg dv, vce(cl mineid) exposure(hours) irr

Fitting Poisson model:

Iteration 0:   log pseudolikelihood = -9569.6223  
Iteration 1:   log pseudolikelihood = -9569.6223  

Fitting constant-only model:

Iteration 0:   log pseudolikelihood = -9249.9658  
Iteration 1:   log pseudolikelihood = -8971.6355  
Iteration 2:   log pseudolikelihood =  -8961.958  
Iteration 3:   log pseudolikelihood = -8961.9317  
Iteration 4:   log pseudolikelihood = -8961.9317  

Fitting full model:

Iteration 0:   log pseudolikelihood = -8961.9317  
Iteration 1:   log pseudolikelihood = -8961.9317  

Negative binomial regression                    Number of obs     =      6,253
                                                Wald chi2(0)      =          .
Dispersion           = mean                     Prob > chi2       =          .
Log pseudolikelihood = -8961.9317               Pseudo R2         =     0.0000

                             (Std. Err. adjusted for 1,238 clusters in mineid)
------------------------------------------------------------------------------
             |               Robust
          dv |        IRR   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       _cons |   .0000108   2.45e-07  -505.30   0.000     .0000103    .0000113
   ln(hours) |          1  (exposure)
-------------+----------------------------------------------------------------
    /lnalpha |  -1.115699   .0832504                     -1.278867   -.9525312
-------------+----------------------------------------------------------------
       alpha |   .3276861     .02728                      .2783525    .3857633
------------------------------------------------------------------------------

. 
. pause "next"

. 
. predict c_null_yhat 
(option n assumed; predicted number of events)

. summ dv c_null_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          dv |      6,253    1.881017    3.268911          0         37
 c_null_yhat |      6,253    1.975549    2.934928   .0006916   30.43051

. 
. pause "complete: null model - count outcome"

. 
. // binary outcome (V & SSV)
. logit dv_indicator, vce(cl mineid) offset(lnhours) or

Iteration 0:   log pseudolikelihood = -3081.8508  
Iteration 1:   log pseudolikelihood = -3080.7305  
Iteration 2:   log pseudolikelihood = -3080.7304  

Logistic regression                             Number of obs     =      6,253
                                                Wald chi2(0)      =          .
Log pseudolikelihood = -3080.7304               Prob > chi2       =          .

                             (Std. Err. adjusted for 1,238 clusters in mineid)
------------------------------------------------------------------------------
             |               Robust
dv_indicator | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       _cons |   .0000159   5.74e-07  -305.50   0.000     .0000148     .000017
     lnhours |          1  (offset)
------------------------------------------------------------------------------

. 
. pause "next"

. 
. lfit

Logistic model for dv_indicator, goodness-of-fit test

       number of observations =      6253
 number of covariate patterns =         1
              Pearson chi2(0) =         0.00
                  Prob > chi2 =              .

. 
. pause "next"

. 
. linktest

Iteration 0:   log likelihood = -4299.6702  
Iteration 1:   log likelihood = -3040.0027  
Iteration 2:   log likelihood = -3016.2028  
Iteration 3:   log likelihood = -3016.1433  
Iteration 4:   log likelihood = -3016.1433  

Logistic regression                             Number of obs     =      6,253
                                                LR chi2(2)        =    2567.05
                                                Prob > chi2       =     0.0000
Log likelihood = -3016.1433                     Pseudo R2         =     0.2985

------------------------------------------------------------------------------
dv_indicator |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        _hat |   1.373769   .0377239    36.42   0.000     1.299831    1.447707
      _hatsq |   .0540479   .0259748     2.08   0.037     .0031383    .1049575
       _cons |   -.105095   .0369067    -2.85   0.004    -.1774307   -.0327593
------------------------------------------------------------------------------

. 
. pause "next"

. 
. estat classification

Logistic model for dv_indicator

              -------- True --------
Classified |         D            ~D  |      Total
-----------+--------------------------+-----------
     +     |      2854           875  |       3729
     -     |       601          1923  |       2524
-----------+--------------------------+-----------
   Total   |      3455          2798  |       6253

Classified + if predicted Pr(D) >= .5
True D defined as dv_indicator != 0
--------------------------------------------------
Sensitivity                     Pr( +| D)   82.60%
Specificity                     Pr( -|~D)   68.73%
Positive predictive value       Pr( D| +)   76.54%
Negative predictive value       Pr(~D| -)   76.19%
--------------------------------------------------
False + rate for true ~D        Pr( +|~D)   31.27%
False - rate for true D         Pr( -| D)   17.40%
False + rate for classified +   Pr(~D| +)   23.46%
False - rate for classified -   Pr( D| -)   23.81%
--------------------------------------------------
Correctly classified                        76.40%
--------------------------------------------------

. 
. pause "next"

. 
. predict b_null_yhat 
(option pr assumed; Pr(dv_indicator))

. summ dv_indicator b_null_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dv_indicator |      6,253    .5525348    .4972722          0          1
 b_null_yhat |      6,253    .5525348    .2479745   .0010138   .9780964

. 
. pause "complete: null model - binary outcome"

. 
. *******************************************************************************/
. ********************************************************************************
. // NULL MODELS (PP)
. 
. // count outcome (PP)
. /*
> glm dv if sample_pp == 1, family(poisson) link(log) vce(cl mineid) exposure(hours) eform
>         
> pause "next"    
>         
> quietly poisson dv if sample_pp == 1, vce(cl mineid) exposure(hours) irr
> estat gof
> 
> pause "next"
>         
> glm dv if sample_pp == 1, family(nbinomial) link(log) vce(cl mineid) exposure(hours) eform
> 
> pause "next"
> */
. 
. nbreg dv if sample_pp == 1, vce(cl mineid) exposure(hours) irr

Fitting Poisson model:

Iteration 0:   log pseudolikelihood = -4869.0583  
Iteration 1:   log pseudolikelihood = -4869.0583  

Fitting constant-only model:

Iteration 0:   log pseudolikelihood = -4833.1956  
Iteration 1:   log pseudolikelihood = -4642.8135  
Iteration 2:   log pseudolikelihood =  -4639.576  
Iteration 3:   log pseudolikelihood =   -4639.57  
Iteration 4:   log pseudolikelihood =   -4639.57  

Fitting full model:

Iteration 0:   log pseudolikelihood =   -4639.57  
Iteration 1:   log pseudolikelihood =   -4639.57  

Negative binomial regression                    Number of obs     =      3,333
                                                Wald chi2(0)      =          .
Dispersion           = mean                     Prob > chi2       =          .
Log pseudolikelihood =   -4639.57               Pseudo R2         =     0.0000

                               (Std. Err. adjusted for 727 clusters in mineid)
------------------------------------------------------------------------------
             |               Robust
          dv |        IRR   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       _cons |   8.67e-06   2.36e-07  -428.85   0.000     8.22e-06    9.15e-06
   ln(hours) |          1  (exposure)
-------------+----------------------------------------------------------------
    /lnalpha |  -1.341963   .1095478                     -1.556673   -1.127253
-------------+----------------------------------------------------------------
       alpha |   .2613322   .0286284                      .2108364    .3239218
------------------------------------------------------------------------------

. 
. pause "next"

. 
. predict c_pp_null_yhat 
(option n assumed; predicted number of events)

. summ dv_indicator c_pp_null_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dv_indicator |      6,253    .5525348    .4972722          0          1
c_pp_null_~t |      6,253    1.585486     2.35544    .000555   24.42215

. 
. pause "complete: null model - count outcome"

. 
. // binary outcome (PP)
. logit dv_indicator if sample_pp == 1, vce(cl mineid) offset(lnhours) or

Iteration 0:   log pseudolikelihood = -1602.7209  
Iteration 1:   log pseudolikelihood = -1602.4493  
Iteration 2:   log pseudolikelihood = -1602.4493  

Logistic regression                             Number of obs     =      3,333
                                                Wald chi2(0)      =          .
Log pseudolikelihood = -1602.4493               Prob > chi2       =          .

                               (Std. Err. adjusted for 727 clusters in mineid)
------------------------------------------------------------------------------
             |               Robust
dv_indicator | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       _cons |    .000013   6.27e-07  -233.81   0.000     .0000119    .0000143
     lnhours |          1  (offset)
------------------------------------------------------------------------------

. 
. pause "next"

. 
. lfit

Logistic model for dv_indicator, goodness-of-fit test

       number of observations =      3333
 number of covariate patterns =         1
              Pearson chi2(0) =         0.00
                  Prob > chi2 =              .

. 
. pause "next"

. 
. linktest

Iteration 0:   log likelihood = -2292.7851  
Iteration 1:   log likelihood =  -1573.272  
Iteration 2:   log likelihood = -1559.4747  
Iteration 3:   log likelihood = -1559.2283  
Iteration 4:   log likelihood =  -1559.228  
Iteration 5:   log likelihood =  -1559.228  

Logistic regression                             Number of obs     =      3,333
                                                LR chi2(2)        =    1467.11
                                                Prob > chi2       =     0.0000
Log likelihood =  -1559.228                     Pseudo R2         =     0.3199

------------------------------------------------------------------------------
dv_indicator |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        _hat |   1.423946   .0520521    27.36   0.000     1.321926    1.525967
      _hatsq |   .0599486   .0366255     1.64   0.102    -.0118361    .1317332
       _cons |  -.1255811   .0521706    -2.41   0.016    -.2278336   -.0233286
------------------------------------------------------------------------------

. 
. pause "next"

. 
. estat classification

Logistic model for dv_indicator

              -------- True --------
Classified |         D            ~D  |      Total
-----------+--------------------------+-----------
     +     |      1542           472  |       2014
     -     |       295          1024  |       1319
-----------+--------------------------+-----------
   Total   |      1837          1496  |       3333

Classified + if predicted Pr(D) >= .5
True D defined as dv_indicator != 0
--------------------------------------------------
Sensitivity                     Pr( +| D)   83.94%
Specificity                     Pr( -|~D)   68.45%
Positive predictive value       Pr( D| +)   76.56%
Negative predictive value       Pr(~D| -)   77.63%
--------------------------------------------------
False + rate for true ~D        Pr( +|~D)   31.55%
False - rate for true D         Pr( -| D)   16.06%
False + rate for classified +   Pr(~D| +)   23.44%
False - rate for classified -   Pr( D| -)   22.37%
--------------------------------------------------
Correctly classified                        76.99%
--------------------------------------------------

. 
. pause "next"

. 
. predict b_pp_null_yhat 
(option pr assumed; Pr(dv_indicator))

. summ dv_indicator b_pp_null_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dv_indicator |      6,253    .5525348    .4972722          0          1
b_pp_null_~t |      6,253    .5157413    .2492313   .0008328   .9734559

. 
. pause "complete: null model - binary outcome"

. 
. ********************************************************************************
. ********************************************************************************
. 
. if "`violation_level'" == "subpart" {
.         set matsize 11000, perm
.         set emptycells drop
. }

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model C.V.1
. 
. // poisson model
. /*
> glm dv `count_vars' `covariates' ib(freq).state ib(freq).time, family(poisson) link(log) vce(cl mineid) exposure(hours) iter(50) eform
>         
> quietly poisson dv `count_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr
> est store pois
> estat gof
>         
> pause "next"
> 
> // negative binomial model
> glm dv `count_vars' `covariates' ib(freq).state ib(freq).time, family(nbinomial) link(log) vce(cl mineid) exposure(hours) iter(50) eform
> 
> pause "next"
> */
. eststo clear

. eststo: nbreg dv `count_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr

Fitting Poisson model:

Iteration 0:   log pseudolikelihood = -11644.439  
Iteration 1:   log pseudolikelihood =  -9008.456  
Iteration 2:   log pseudolikelihood = -8966.1047  
Iteration 3:   log pseudolikelihood = -8961.6107  
Iteration 4:   log pseudolikelihood = -8961.5525  
Iteration 5:   log pseudolikelihood = -8961.5525  

Fitting constant-only model:

Iteration 0:   log pseudolikelihood = -9249.9658  
Iteration 1:   log pseudolikelihood = -8971.6355  
Iteration 2:   log pseudolikelihood =  -8961.958  
Iteration 3:   log pseudolikelihood = -8961.9317  
Iteration 4:   log pseudolikelihood = -8961.9317  

Fitting full model:

Iteration 0:   log pseudolikelihood = -8699.9995  
Iteration 1:   log pseudolikelihood = -8663.3027  
Iteration 2:   log pseudolikelihood = -8662.4216  
Iteration 3:   log pseudolikelihood = -8662.4211  

Negative binomial regression                    Number of obs     =      6,253
                                                Wald chi2(36)     =          .
Dispersion           = mean                     Prob > chi2       =          .
Log pseudolikelihood = -8662.4211               Pseudo R2         =     0.0334

                                  (Std. Err. adjusted for 1,238 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
               dv |        IRR   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
              p47 |   1.058048   .0825286     0.72   0.469     .9080531    1.232821
              p48 |   1.001612   .0058735     0.27   0.784      .990166     1.01319
              p71 |   .9947945   .0400837    -0.13   0.897     .9192539    1.076543
              p72 |   .9972163   .0249861    -0.11   0.911     .9494275    1.047411
              p75 |   1.001401   .0003129     4.48   0.000     1.000788    1.002014
              p77 |   .9952932   .0055173    -0.85   0.395     .9845381    1.006166
        mine_time |   .9959231   .0073019    -0.56   0.577     .9817139    1.010338
onsite_insp_hours |   .9998743   .0000524    -2.40   0.017     .9997716    .9999771
         longwall |   .8300322   .0646047    -2.39   0.017     .7125946    .9668239
                  |
            state |
               1  |   1.170748   .1192057     1.55   0.122     .9589456    1.429331
               2  |   1.904024    .101984    12.02   0.000     1.714273    2.114778
               3  |    .803999   .1377398    -1.27   0.203     .5746839    1.124817
               4  |   1.104548   .1030529     1.07   0.287     .9199596    1.326175
               5  |    .871715    .142805    -0.84   0.402       .63231    1.201764
               6  |   .9196919   .0462616    -1.66   0.096      .833347    1.014983
               7  |   .9534031   .2212088    -0.21   0.837     .6050351    1.502355
               8  |   1.132771    .080924     1.75   0.081     .9847661     1.30302
               9  |   .8652582   .0642055    -1.95   0.051     .7481407     1.00071
              10  |   1.039652   .1717547     0.24   0.814     .7520833    1.437176
              11  |   .8659765      .2137    -0.58   0.560     .5338905    1.404624
              12  |   1.009811   .0849969     0.12   0.908     .8562365    1.190931
              13  |    1.31694   .1959901     1.85   0.064     .9837574    1.762965
              14  |   .6960975   .0907024    -2.78   0.005     .5392094    .8986337
              15  |   .6720489    .046048    -5.80   0.000     .5875942    .7686423
              17  |   1.243375   .0996004     2.72   0.007     1.062715    1.454747
                  |
             time |
            2000  |   1.097908   .0656715     1.56   0.118     .9764531    1.234471
            2002  |   .9906909   .0595011    -0.16   0.876     .8806734    1.114452
            2003  |   .8789515   .0564941    -2.01   0.045     .7749156    .9969547
            2004  |   .8813321   .0581916    -1.91   0.056     .7743503    1.003094
            2005  |   .7712071   .0498429    -4.02   0.000     .6794509    .8753545
            2006  |   .7584011   .0540628    -3.88   0.000     .6595093    .8721216
            2007  |   .7013454   .0520769    -4.78   0.000     .6063561    .8112152
            2008  |    .625801   .0461017    -6.36   0.000     .5416636    .7230076
            2009  |     .53753   .0422505    -7.90   0.000     .4607839    .6270586
            2010  |   .5430012   .0442456    -7.49   0.000     .4628519    .6370295
            2011  |   .5818784   .0479559    -6.57   0.000     .4950851    .6838874
            2012  |   .5981291   .0505815    -6.08   0.000     .5067715    .7059562
            2013  |   .5254959    .049621    -6.81   0.000     .4367098    .6323329
            2014  |    .504323   .0475541    -7.26   0.000     .4192244    .6066958
            2015  |   .5366232   .0550603    -6.07   0.000     .4388658     .656156
                  |
            _cons |   .0000168   1.00e-06  -185.09   0.000      .000015    .0000189
        ln(hours) |          1  (exposure)
------------------+----------------------------------------------------------------
         /lnalpha |  -1.538579   .0978612                     -1.730383   -1.346774
------------------+----------------------------------------------------------------
            alpha |    .214686   .0210094                      .1772165    .2600778
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.C.V.1.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.V.1.csv not foun
> d)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.V.1.csv)

. /* 
> est store nbin
> 
> pause "next"
> 
> // test for over-dispersion
> lrtest pois nbin, stats force 
> 
> pause "next" 
> 
> // final model + diagnostics/assessment
> quietly nbreg dv `count_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr
> */
. predict cv1_yhat 
(option n assumed; predicted number of events)

. gen cv1_res = dv - cv1_yhat

. 
. summ dv cv1_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          dv |      6,253    1.881017    3.268911          0         37
    cv1_yhat |      6,253    1.915176    2.867672   .0006279   34.21974

. /*
> pause "next"
> 
> scatter dv cv1_yhat
> 
> pause "next"
> 
> scatter cv1_res dv
> 
> pause "next"
> 
> scatter cv1_res cv1_yhat
> */
. pause "complete: C.V.1"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model C.V.2
. 
. // poisson model
. /*
> glm dv `count_lag_1_vars' `covariates' ib(freq).state ib(freq).time, family(poisson) link(log) vce(cl mineid) exposure(hours) iter(50) eform
>         
> quietly poisson dv `count_lag_1_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr
> est store pois
> estat gof
>         
> pause "next"
> 
> // negative binomial model
> glm dv `count_lag_1_vars' `covariates' ib(freq).state ib(freq).time, family(nbinomial) link(log) vce(cl mineid) exposure(hours) iter(50) eform
> 
> pause "next"
> */
. eststo clear

. eststo: nbreg dv `count_lag_1_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr

Fitting Poisson model:

Iteration 0:   log pseudolikelihood = -11222.502  
Iteration 1:   log pseudolikelihood = -8983.4203  
Iteration 2:   log pseudolikelihood = -8963.8041  
Iteration 3:   log pseudolikelihood = -8963.3841  
Iteration 4:   log pseudolikelihood = -8963.3835  

Fitting constant-only model:

Iteration 0:   log pseudolikelihood = -9249.9658  
Iteration 1:   log pseudolikelihood = -8971.6355  
Iteration 2:   log pseudolikelihood =  -8961.958  
Iteration 3:   log pseudolikelihood = -8961.9317  
Iteration 4:   log pseudolikelihood = -8961.9317  

Fitting full model:

Iteration 0:   log pseudolikelihood = -8702.3911  
Iteration 1:   log pseudolikelihood = -8665.8574  
Iteration 2:   log pseudolikelihood = -8664.9815  
Iteration 3:   log pseudolikelihood = -8664.9811  

Negative binomial regression                    Number of obs     =      6,253
                                                Wald chi2(36)     =          .
Dispersion           = mean                     Prob > chi2       =          .
Log pseudolikelihood = -8664.9811               Pseudo R2         =     0.0331

                                  (Std. Err. adjusted for 1,238 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
               dv |        IRR   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
         p47_1lag |   1.031006   .0752215     0.42   0.676     .8936308      1.1895
         p48_1lag |   1.002101   .0057847     0.36   0.716      .990827    1.013503
         p71_1lag |   .9433838   .0445374    -1.23   0.217     .8600089    1.034842
         p72_1lag |   1.003554   .0261749     0.14   0.892     .9535413     1.05619
         p75_1lag |    1.00132   .0003091     4.27   0.000     1.000715    1.001926
         p77_1lag |   .9966819    .005141    -0.64   0.519     .9866564    1.006809
        mine_time |   .9951158    .007236    -0.67   0.501      .981034      1.0094
onsite_insp_hours |    .999883   .0000512    -2.28   0.022     .9997826    .9999834
         longwall |   .8337854   .0640912    -2.36   0.018     .7171738     .969358
                  |
            state |
               1  |   1.165564   .1171935     1.52   0.128     .9570851    1.419454
               2  |   1.913149   .1027266    12.08   0.000     1.722041    2.125466
               3  |   .7967829   .1375147    -1.32   0.188     .5681111    1.117498
               4  |   1.104242   .1010353     1.08   0.278     .9229572    1.321134
               5  |   .8711946   .1424645    -0.84   0.399     .6322955    1.200357
               6  |   .9185563   .0462868    -1.69   0.092     .8321719    1.013908
               7  |   .9510065   .2195282    -0.22   0.828     .6049147    1.495109
               8  |   1.113314   .0776793     1.54   0.124      .971017    1.276464
               9  |   .8744626   .0656705    -1.79   0.074     .7547751    1.013129
              10  |   1.045755   .1763257     0.27   0.791     .7514642    1.455298
              11  |   .8635217   .2112257    -0.60   0.549     .5346396    1.394715
              12  |   1.005172   .0846574     0.06   0.951      .852218    1.185578
              13  |   1.313032   .1960859     1.82   0.068     .9798469    1.759512
              14  |   .6892001   .0906905    -2.83   0.005     .5325217    .8919763
              15  |   .6681303   .0463484    -5.81   0.000      .583194    .7654366
              17  |    1.23585   .0988369     2.65   0.008     1.056552    1.445574
                  |
             time |
            2000  |   1.114863   .0671771     1.80   0.071     .9906759    1.254618
            2002  |   .9843626   .0588847    -0.26   0.792     .8754596    1.106813
            2003  |   .8765486   .0563293    -2.05   0.040      .772815    .9942061
            2004  |   .8860898   .0585618    -1.83   0.067     .7784338    1.008634
            2005  |   .7710257   .0496863    -4.04   0.000     .6795414    .8748262
            2006  |    .761492   .0544205    -3.81   0.000      .661963    .8759856
            2007  |   .7101691   .0525316    -4.63   0.000     .6143246     .820967
            2008  |   .6278028   .0464761    -6.29   0.000     .5430115    .7258343
            2009  |   .5353837   .0420725    -7.95   0.000     .4589597    .6245335
            2010  |   .5448496   .0445859    -7.42   0.000     .4641107    .6396343
            2011  |   .5820688   .0481358    -6.54   0.000     .4949734    .6844896
            2012  |   .5960001   .0504147    -6.12   0.000     .5049456    .7034741
            2013  |   .5219376   .0490141    -6.92   0.000     .4341942    .6274124
            2014  |   .5063761   .0476236    -7.24   0.000     .4211332    .6088732
            2015  |    .532966   .0551986    -6.08   0.000     .4350526    .6529161
                  |
            _cons |   .0000169   1.01e-06  -184.63   0.000     .0000151     .000019
        ln(hours) |          1  (exposure)
------------------+----------------------------------------------------------------
         /lnalpha |  -1.537627   .0976255                     -1.728969   -1.346284
------------------+----------------------------------------------------------------
            alpha |   .2148905   .0209788                      .1774673    .2602054
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.C.V.2.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.V.2.csv not foun
> d)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.V.2.csv)

. /*
> est store nbin
> 
> pause "next"
> 
> // test for over-dispersion
> lrtest pois nbin, stats force 
> 
> pause "next" 
> 
> // final model + diagnostics/assessment
> quietly nbreg dv `count_lag_1_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr
> */
. predict cv2_yhat 
(option n assumed; predicted number of events)

. gen cv2_res = dv - cv2_yhat

. 
. summ dv cv2_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          dv |      6,253    1.881017    3.268911          0         37
    cv2_yhat |      6,253     1.91288    2.846498   .0006311    29.8097

. /*
> pause "next"
> 
> scatter dv cv2_yhat
> 
> pause "next"
> 
> scatter cv2_res dv
> 
> pause "next"
> 
> scatter cv2_res cv2_yhat
> */
. pause "complete: C.V.2"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model C.V.3
. 
. // poisson model
. /*
> glm dv `count_lag_4_vars' `covariates' ib(freq).state ib(freq).time, family(poisson) link(log) vce(cl mineid) exposure(hours) iter(50) eform
>         
> quietly poisson dv `count_lag_4_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr
> est store pois
> estat gof
>         
> pause "next"
> 
> // negative binomial model
> glm dv `count_lag_4_vars' `covariates' ib(freq).state ib(freq).time, family(nbinomial) link(log) vce(cl mineid) exposure(hours) iter(50) eform
> 
> pause "next"
> */
. eststo clear

. eststo: nbreg dv `count_lag_4_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr

Fitting Poisson model:

Iteration 0:   log pseudolikelihood = -11010.399  
Iteration 1:   log pseudolikelihood =  -8980.877  
Iteration 2:   log pseudolikelihood = -8966.6242  
Iteration 3:   log pseudolikelihood =  -8966.581  
Iteration 4:   log pseudolikelihood =  -8966.581  

Fitting constant-only model:

Iteration 0:   log pseudolikelihood = -9249.9658  
Iteration 1:   log pseudolikelihood = -8971.6355  
Iteration 2:   log pseudolikelihood =  -8961.958  
Iteration 3:   log pseudolikelihood = -8961.9317  
Iteration 4:   log pseudolikelihood = -8961.9317  

Fitting full model:

Iteration 0:   log pseudolikelihood = -8704.3729  
Iteration 1:   log pseudolikelihood = -8668.4393  
Iteration 2:   log pseudolikelihood = -8667.5881  
Iteration 3:   log pseudolikelihood = -8667.5877  

Negative binomial regression                    Number of obs     =      6,253
                                                Wald chi2(36)     =          .
Dispersion           = mean                     Prob > chi2       =          .
Log pseudolikelihood = -8667.5877               Pseudo R2         =     0.0328

                                  (Std. Err. adjusted for 1,238 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
               dv |        IRR   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
       p47_c_4lag |   1.009734   .0238669     0.41   0.682     .9640222    1.057612
       p48_c_4lag |   1.001239   .0024297     0.51   0.610     .9964882    1.006013
       p71_c_4lag |   .9782618   .0157898    -1.36   0.173     .9477987    1.009704
       p72_c_4lag |   1.000382   .0076569     0.05   0.960     .9854871    1.015503
       p75_c_4lag |   1.000319   .0000795     4.01   0.000     1.000163    1.000474
       p77_c_4lag |    .998758   .0016162    -0.77   0.443     .9955954    1.001931
        mine_time |   .9940636   .0072065    -0.82   0.411     .9800391    1.008289
onsite_insp_hours |   .9998927   .0000503    -2.13   0.033     .9997941    .9999913
         longwall |   .8426648   .0641886    -2.25   0.025     .7257983    .9783488
                  |
            state |
               1  |   1.161892   .1154036     1.51   0.131     .9563597    1.411596
               2  |   1.935469    .102802    12.43   0.000     1.744114    2.147819
               3  |   .7978689   .1396775    -1.29   0.197     .5661316    1.124464
               4  |   1.104509   .1002522     1.10   0.273     .9245044    1.319562
               5  |    .871742   .1422471    -0.84   0.400     .6331295    1.200282
               6  |   .9168283   .0461794    -1.72   0.085     .8306425    1.011957
               7  |   .9524458   .2185355    -0.21   0.832     .6074842    1.493295
               8  |   1.107764   .0787487     1.44   0.150     .9636891    1.273378
               9  |   .8760183   .0660337    -1.76   0.079     .7557012    1.015491
              10  |   1.047623   .1781822     0.27   0.784     .7506384    1.462108
              11  |   .8705402    .213343    -0.57   0.572     .5384993    1.407319
              12  |   1.000062   .0845549     0.00   0.999     .8473406    1.180309
              13  |   1.309723   .1956125     1.81   0.071     .9773473    1.755132
              14  |   .6841196   .0906034    -2.87   0.004     .5277165    .8868771
              15  |   .6669872   .0464972    -5.81   0.000     .5818061    .7646396
              17  |   1.233354   .1003599     2.58   0.010     1.051537     1.44661
                  |
             time |
            2000  |   1.146065   .0711438     2.20   0.028     1.014774    1.294341
            2002  |   .9793673   .0582186    -0.35   0.726     .8716574    1.100387
            2003  |   .8762938   .0565435    -2.05   0.041     .7721921    .9944297
            2004  |   .8874338   .0588082    -1.80   0.072     .7793433    1.010516
            2005  |   .7710401   .0495435    -4.05   0.000     .6798024     .874523
            2006  |   .7650672   .0548889    -3.73   0.000     .6647082    .8805785
            2007  |   .7109508    .052525    -4.62   0.000       .61511    .8217245
            2008  |   .6330887   .0468332    -6.18   0.000     .5476415    .7318682
            2009  |   .5350586   .0422465    -7.92   0.000     .4583458    .6246107
            2010  |   .5468722   .0445713    -7.41   0.000     .4661343    .6415945
            2011  |   .5800228   .0481329    -6.56   0.000     .4929564    .6824669
            2012  |    .594659   .0504644    -6.12   0.000     .5035385    .7022688
            2013  |   .5206295   .0490642    -6.93   0.000     .4328242    .6262476
            2014  |    .505557   .0477948    -7.21   0.000     .4200476    .6084736
            2015  |   .5301459   .0547251    -6.15   0.000     .4330408    .6490258
                  |
            _cons |   .0000171   1.01e-06  -184.96   0.000     .0000152    .0000192
        ln(hours) |          1  (exposure)
------------------+----------------------------------------------------------------
         /lnalpha |   -1.53598   .0973303                     -1.726744   -1.345216
------------------+----------------------------------------------------------------
            alpha |   .2152447   .0209498                      .1778627    .2604835
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.C.V.3.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.V.3.csv not foun
> d)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.V.3.csv)

. /*
> est store nbin
> 
> pause "next"
> 
> // test for over-dispersion
> lrtest pois nbin, stats force 
> 
> pause "next" 
> 
> // final model + diagnostics/assessment
> quietly nbreg dv `count_lag_4_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr
> */
. predict cv3_yhat 
(option n assumed; predicted number of events)

. gen cv3_res = dv - cv3_yhat

. 
. summ dv cv3_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          dv |      6,253    1.881017    3.268911          0         37
    cv3_yhat |      6,253    1.911432    2.831847   .0006324   29.23247

. 
. pause "next"

. /*
> scatter dv cv3_yhat
> 
> pause "next"
> 
> scatter cv3_res dv
> 
> pause "next"
> 
> scatter cv3_res cv3_yhat
> */
. pause "complete: C.V.3"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model C.V.4
. 
. // poisson model
. /*
> glm dv `count_lag_all_vars' `covariates' ib(freq).state ib(freq).time, family(poisson) link(log) vce(cl mineid) exposure(hours) iter(50) eform
>         
> quietly poisson dv `count_lag_all_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr
> est store pois
> estat gof
>         
> pause "next"
> 
> // negative binomial model
> glm dv `count_lag_all_vars' `covariates' ib(freq).state ib(freq).time, family(nbinomial) link(log) vce(cl mineid) exposure(hours) iter(50) eform
> 
> pause "next"
> */
. eststo clear

. eststo: nbreg dv `count_lag_all_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr

Fitting Poisson model:

Iteration 0:   log pseudolikelihood = -10998.746  
Iteration 1:   log pseudolikelihood = -8982.4011  
Iteration 2:   log pseudolikelihood = -8971.4066  
Iteration 3:   log pseudolikelihood = -8971.3885  
Iteration 4:   log pseudolikelihood = -8971.3885  

Fitting constant-only model:

Iteration 0:   log pseudolikelihood = -9249.9658  
Iteration 1:   log pseudolikelihood = -8971.6355  
Iteration 2:   log pseudolikelihood =  -8961.958  
Iteration 3:   log pseudolikelihood = -8961.9317  
Iteration 4:   log pseudolikelihood = -8961.9317  

Fitting full model:

Iteration 0:   log pseudolikelihood = -8709.9579  
Iteration 1:   log pseudolikelihood = -8677.0461  
Iteration 2:   log pseudolikelihood = -8676.2907  
Iteration 3:   log pseudolikelihood = -8676.2904  

Negative binomial regression                    Number of obs     =      6,253
                                                Wald chi2(36)     =          .
Dispersion           = mean                     Prob > chi2       =          .
Log pseudolikelihood = -8676.2904               Pseudo R2         =     0.0319

                                  (Std. Err. adjusted for 1,238 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
               dv |        IRR   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
    p47_c_lag_all |   1.014311   .0086607     1.66   0.096     .9974774    1.031428
    p48_c_lag_all |   1.001288   .0012478     1.03   0.302     .9988456    1.003737
    p71_c_lag_all |   .9965633   .0058936    -0.58   0.560     .9850787    1.008182
    p72_c_lag_all |   1.002478    .003054     0.81   0.416     .9965106    1.008482
    p75_c_lag_all |   1.000027   .0000125     2.17   0.030     1.000003    1.000051
    p77_c_lag_all |     .99938   .0005037    -1.23   0.219     .9983932    1.000368
        mine_time |   .9879265   .0076596    -1.57   0.117     .9730275    1.003054
onsite_insp_hours |   .9999723   .0000379    -0.73   0.464     .9998981    1.000046
         longwall |   .8585919   .0665767    -1.97   0.049      .737536    .9995175
                  |
            state |
               1  |   1.107693   .1007444     1.12   0.261     .9268364    1.323842
               2  |   1.965409   .1037716    12.80   0.000      1.77219    2.179694
               3  |    .793928    .157388    -1.16   0.244     .5383185    1.170909
               4  |   1.090129   .0913525     1.03   0.303     .9250119    1.284719
               5  |   .8485091   .1354037    -1.03   0.303     .6206163    1.160085
               6  |    .891923   .0453541    -2.25   0.024     .8073168    .9853959
               7  |    .957259   .2174027    -0.19   0.847     .6133572    1.493983
               8  |   1.055883   .0779738     0.74   0.462     .9136022    1.220322
               9  |   .8054172   .0656245    -2.66   0.008       .68654    .9448783
              10  |   1.005271   .1701313     0.03   0.975     .7214837    1.400683
              11  |    .885355   .2145064    -0.50   0.615     .5506629    1.423472
              12  |   .9458431   .0812656    -0.65   0.517     .7992542    1.119317
              13  |   1.261536     .19225     1.52   0.127     .9357978    1.700659
              14  |   .6563866   .0895372    -3.09   0.002     .5023981    .8575736
              15  |   .6576754   .0470603    -5.86   0.000     .5716147    .7566931
              17  |   1.206689   .1166816     1.94   0.052      .998362    1.458489
                  |
             time |
            2000  |   1.084111   .0644397     1.36   0.174     .9648907    1.218062
            2002  |   .9807392   .0578677    -0.33   0.742     .8736331    1.100976
            2003  |   .8771301   .0557289    -2.06   0.039     .7744306    .9934488
            2004  |   .8828087   .0577918    -1.90   0.057     .7765045    1.003666
            2005  |   .7687581   .0487606    -4.15   0.000     .6788908    .8705214
            2006  |   .7715695   .0543329    -3.68   0.000     .6721011    .8857588
            2007  |   .7177245   .0526382    -4.52   0.000     .6216277    .8286768
            2008  |   .6407169   .0468391    -6.09   0.000     .5551875    .7394224
            2009  |   .5438079   .0433892    -7.63   0.000     .4650825    .6358592
            2010  |   .5447628   .0448296    -7.38   0.000     .4636182    .6401098
            2011  |   .5751239   .0474902    -6.70   0.000     .4891864    .6761584
            2012  |   .5783139   .0490768    -6.45   0.000     .4896988    .6829645
            2013  |   .5037921   .0475037    -7.27   0.000     .4187835    .6060565
            2014  |   .4868352   .0472487    -7.42   0.000     .4025042    .5888348
            2015  |   .5028344   .0525189    -6.58   0.000     .4097515    .6170628
                  |
            _cons |   .0000181   1.11e-06  -177.65   0.000      .000016    .0000204
        ln(hours) |          1  (exposure)
------------------+----------------------------------------------------------------
         /lnalpha |  -1.534921   .0960619                     -1.723199   -1.346643
------------------+----------------------------------------------------------------
            alpha |   .2154727   .0206987                      .1784943     .260112
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.C.V.4.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.V.4.csv not foun
> d)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.V.4.csv)

. /*
> est store nbin
> 
> pause "next"
> 
> // test for over-dispersion
> lrtest pois nbin, stats force 
> 
> pause "next" 
> 
> // final model + diagnostics/assessment
> quietly nbreg dv `count_lag_all_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr
> */
. predict cv4_yhat 
(option n assumed; predicted number of events)

. gen cv4_res = dv - cv4_yhat

. 
. summ dv cv4_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          dv |      6,253    1.881017    3.268911          0         37
    cv4_yhat |      6,253    1.901128    2.735904   .0006306   23.14095

. /*
> pause "next"
> 
> scatter dv cv4_yhat
> 
> pause "next"
> 
> scatter cv4_res dv
> 
> pause "next"
> 
> scatter cv4_res cv4_yhat
> */
. pause "complete: C.V.4"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model C.SSV.1
. 
. // poisson model
. /*
> glm dv `ss_vars' `covariates' ib(freq).state ib(freq).time, family(poisson) link(log) vce(cl mineid) exposure(hours) iter(50) eform
>         
> quietly poisson dv `count_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr
> est store pois
> estat gof
>         
> pause "next"
> 
> // negative binomial model
> glm dv `ss_vars' `covariates' ib(freq).state ib(freq).time, family(nbinomial) link(log) vce(cl mineid) exposure(hours) iter(50) eform
> 
> pause "next"
> */
. eststo clear

. eststo: nbreg dv `ss_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr

Fitting Poisson model:

Iteration 0:   log pseudolikelihood = -10701.292  
Iteration 1:   log pseudolikelihood = -8977.7451  
Iteration 2:   log pseudolikelihood = -8965.6428  
Iteration 3:   log pseudolikelihood = -8965.6308  
Iteration 4:   log pseudolikelihood = -8965.6308  

Fitting constant-only model:

Iteration 0:   log pseudolikelihood = -9249.9658  
Iteration 1:   log pseudolikelihood = -8971.6355  
Iteration 2:   log pseudolikelihood =  -8961.958  
Iteration 3:   log pseudolikelihood = -8961.9317  
Iteration 4:   log pseudolikelihood = -8961.9317  

Fitting full model:

Iteration 0:   log pseudolikelihood = -8700.2326  
Iteration 1:   log pseudolikelihood = -8663.8372  
Iteration 2:   log pseudolikelihood = -8662.9808  
Iteration 3:   log pseudolikelihood = -8662.9804  

Negative binomial regression                    Number of obs     =      6,253
                                                Wald chi2(36)     =          .
Dispersion           = mean                     Prob > chi2       =          .
Log pseudolikelihood = -8662.9804               Pseudo R2         =     0.0334

                                  (Std. Err. adjusted for 1,238 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
               dv |        IRR   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
           p47_ss |   .9561721   .2622275    -0.16   0.870     .5585943    1.636725
           p48_ss |   .9985121   .0272882    -0.05   0.957     .9464355    1.053454
           p71_ss |   .7791005   .1032747    -1.88   0.060     .6008435    1.010242
           p72_ss |   .9232069   .0678933    -1.09   0.277     .7992838    1.066343
           p75_ss |   1.003552   .0008225     4.33   0.000     1.001941    1.005165
           p77_ss |   1.016022   .0179682     0.90   0.369     .9814081    1.051856
        mine_time |   .9965205   .0073092    -0.48   0.635     .9822972     1.01095
onsite_insp_hours |   .9999166    .000047    -1.78   0.076     .9998245    1.000009
         longwall |   .8306377   .0645512    -2.39   0.017     .7132839    .9672993
                  |
            state |
               1  |    1.13018   .1130932     1.22   0.221     .9289041    1.375069
               2  |   1.786661   .0995797    10.41   0.000     1.601771    1.992893
               3  |   .8211439   .1413902    -1.14   0.252     .5859405    1.150761
               4  |   1.154555   .1109305     1.50   0.135     .9563802    1.393794
               5  |   .8933105   .1438777    -0.70   0.484     .6514886    1.224893
               6  |   .9167728   .0460279    -1.73   0.083     .8308563    1.011574
               7  |   .9452352   .2205212    -0.24   0.809     .5983518    1.493218
               8  |   1.084334   .0720069     1.22   0.223      .952002    1.235061
               9  |   .8635687   .0604669    -2.09   0.036     .7528283    .9905988
              10  |   1.026231   .1691591     0.16   0.875     .7429115    1.417598
              11  |   .8384102   .2103833    -0.70   0.482     .5127002    1.371038
              12  |   .9679374   .0815927    -0.39   0.699     .8205308    1.141825
              13  |   1.303263   .1955265     1.77   0.077     .9712419    1.748785
              14  |   .6887238    .091053    -2.82   0.005     .5315103    .8924389
              15  |   .6582353   .0487519    -5.65   0.000     .5692948    .7610707
              17  |    1.23691   .0928581     2.83   0.005     1.067668     1.43298
                  |
             time |
            2000  |   1.100882   .0658691     1.61   0.108     .9790634    1.237858
            2002  |   .9946318   .0597493    -0.09   0.929     .8841565    1.118911
            2003  |   .8830748   .0570301    -1.93   0.054     .7780827    1.002234
            2004  |   .8757345   .0585016    -1.99   0.047     .7682626    .9982405
            2005  |   .7721739   .0502832    -3.97   0.000     .6796507    .8772927
            2006  |   .7528942   .0537172    -3.98   0.000     .6546404    .8658948
            2007  |    .707616   .0518107    -4.72   0.000     .6130188    .8168109
            2008  |   .6411211   .0477974    -5.96   0.000     .5539628    .7419926
            2009  |   .5587094   .0443181    -7.34   0.000      .478263    .6526874
            2010  |   .5593758   .0455301    -7.14   0.000     .4768925    .6561253
            2011  |   .5972253   .0494673    -6.22   0.000     .5077318    .7024929
            2012  |   .6176177   .0524317    -5.68   0.000     .5229478    .7294258
            2013  |    .540611   .0507625    -6.55   0.000     .4497367    .6498474
            2014  |   .5222372   .0492064    -6.89   0.000     .4341759    .6281596
            2015  |   .5568483   .0579883    -5.62   0.000     .4540417    .6829331
                  |
            _cons |   .0000166   9.92e-07  -183.97   0.000     .0000147    .0000186
        ln(hours) |          1  (exposure)
------------------+----------------------------------------------------------------
         /lnalpha |  -1.535419   .0966707                      -1.72489   -1.345948
------------------+----------------------------------------------------------------
            alpha |   .2153654   .0208195                      .1781926    .2602928
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.C.SSV.1.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.SSV.1.csv not fo
> und)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.SSV.1.csv
> )

. /*
> est store nbin
> 
> pause "next"
> 
> // test for over-dispersion
> lrtest pois nbin, stats force 
> 
> pause "next" 
> 
> // final model + diagnostics/assessment
> quietly nbreg dv `ss_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr
> */
. predict cssv1_yhat 
(option n assumed; predicted number of events)

. gen cssv1_res = dv - cssv1_yhat

. 
. summ dv cssv1_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          dv |      6,253    1.881017    3.268911          0         37
  cssv1_yhat |      6,253     1.91139     2.83002   .0006428   33.88642

. /*
> pause "next"
> 
> scatter dv cssv1_yhat
> 
> pause "next"
> 
> scatter cssv1_res dv
> 
> pause "next"
> 
> scatter cssv1_res cssv1_yhat
> */
. pause "complete: C.SSV.1"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model C.SSV.2
. 
. // poisson model
. /*
> glm dv `ss_lag_1_vars' `covariates' ib(freq).state ib(freq).time, family(poisson) link(log) vce(cl mineid) exposure(hours) iter(50) eform
>         
> quietly poisson dv `ss_lag_1_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr
> est store pois
> estat gof
>         
> pause "next"
> 
> // negative binomial model
> glm dv `ss_lag_1_vars' `covariates' ib(freq).state ib(freq).time, family(nbinomial) link(log) vce(cl mineid) exposure(hours) iter(50) eform
> 
> pause "next"
> */
. eststo clear

. eststo: nbreg dv `ss_lag_1_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr

Fitting Poisson model:

Iteration 0:   log pseudolikelihood =  -10628.58  
Iteration 1:   log pseudolikelihood = -8973.7064  
Iteration 2:   log pseudolikelihood = -8962.5384  
Iteration 3:   log pseudolikelihood = -8962.5277  
Iteration 4:   log pseudolikelihood = -8962.5277  

Fitting constant-only model:

Iteration 0:   log pseudolikelihood = -9249.9658  
Iteration 1:   log pseudolikelihood = -8971.6355  
Iteration 2:   log pseudolikelihood =  -8961.958  
Iteration 3:   log pseudolikelihood = -8961.9317  
Iteration 4:   log pseudolikelihood = -8961.9317  

Fitting full model:

Iteration 0:   log pseudolikelihood = -8700.5593  
Iteration 1:   log pseudolikelihood = -8664.1939  
Iteration 2:   log pseudolikelihood = -8663.3367  
Iteration 3:   log pseudolikelihood = -8663.3363  

Negative binomial regression                    Number of obs     =      6,253
                                                Wald chi2(36)     =          .
Dispersion           = mean                     Prob > chi2       =          .
Log pseudolikelihood = -8663.3363               Pseudo R2         =     0.0333

                                  (Std. Err. adjusted for 1,238 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
               dv |        IRR   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
      p47_ss_1lag |   .9765871   .2192288    -0.11   0.916      .628969    1.516326
      p48_ss_1lag |   .9952306   .0233104    -0.20   0.838     .9505758    1.041983
      p71_ss_1lag |   .8126892   .1151023    -1.46   0.143     .6156978    1.072708
      p72_ss_1lag |    .997605   .0876324    -0.03   0.978     .8398209    1.185033
      p75_ss_1lag |   1.003596   .0008197     4.39   0.000     1.001991    1.005204
      p77_ss_1lag |   1.015502   .0172427     0.91   0.365     .9822627    1.049865
        mine_time |   .9957992   .0072872    -0.58   0.565     .9816186    1.010185
onsite_insp_hours |   .9999172   .0000466    -1.78   0.076     .9998258    1.000009
         longwall |   .8295566   .0648854    -2.39   0.017     .7116518    .9669955
                  |
            state |
               1  |   1.133426   .1135813     1.25   0.211      .931309    1.379408
               2  |   1.797392   .0986629    10.68   0.000     1.614055    2.001553
               3  |    .817985    .139745    -1.18   0.240     .5852286    1.143313
               4  |   1.155104   .1101761     1.51   0.131     .9581465    1.392549
               5  |   .8953875    .143789    -0.69   0.491     .6536087    1.226604
               6  |   .9175764   .0462759    -1.71   0.088     .8312158     1.01291
               7  |   .9455288   .2193053    -0.24   0.809     .6001332    1.489711
               8  |   1.089701   .0725897     1.29   0.197      .956324     1.24168
               9  |   .8612065   .0602605    -2.14   0.033     .7508391     .987797
              10  |   1.028967   .1703288     0.17   0.863     .7438732    1.423325
              11  |   .8400954   .2103458    -0.70   0.486     .5142828    1.372319
              12  |   .9685881   .0819961    -0.38   0.706     .8205034    1.143399
              13  |   1.295065   .1940891     1.73   0.084     .9654357    1.737239
              14  |   .6836571   .0934159    -2.78   0.005     .5230328    .8936095
              15  |   .6576595   .0488439    -5.64   0.000     .5685688    .7607102
              17  |   1.240735   .0938474     2.85   0.004     1.069782    1.439006
                  |
             time |
            2000  |   1.119938    .067458     1.88   0.060      .995229    1.260274
            2002  |   .9873441   .0591266    -0.21   0.832     .8780006    1.110305
            2003  |   .8789177   .0565386    -2.01   0.045     .7748052    .9970201
            2004  |   .8768619   .0582478    -1.98   0.048     .7698178    .9987906
            2005  |   .7670917   .0500431    -4.06   0.000     .6750207    .8717211
            2006  |   .7542898   .0539592    -3.94   0.000     .6556111     .867821
            2007  |   .7075325   .0517854    -4.73   0.000     .6129791     .816671
            2008  |   .6397809   .0475092    -6.01   0.000     .5531236    .7400146
            2009  |   .5518034    .043642    -7.52   0.000     .4725666    .6443261
            2010  |   .5596839   .0459378    -7.07   0.000     .4765162     .657367
            2011  |    .596975   .0494697    -6.23   0.000     .5074805    .7022519
            2012  |   .6152365   .0523368    -5.71   0.000     .5207536    .7268619
            2013  |   .5394213   .0507491    -6.56   0.000     .4485868     .648649
            2014  |   .5214892   .0490987    -6.92   0.000     .4336145    .6271722
            2015  |    .554049   .0581441    -5.63   0.000     .4510448    .6805761
                  |
            _cons |   .0000167   1.00e-06  -183.31   0.000     .0000148    .0000187
        ln(hours) |          1  (exposure)
------------------+----------------------------------------------------------------
         /lnalpha |   -1.53904    .096825                     -1.728814   -1.349267
------------------+----------------------------------------------------------------
            alpha |   .2145869   .0207774                      .1774948    .2594304
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.C.SSV.2.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.SSV.2.csv not fo
> und)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.SSV.2.csv
> )

. /*
> est store nbin
> 
> pause "next"
> 
> // test for over-dispersion
> lrtest pois nbin, stats force 
> 
> pause "next" 
> 
> // final model + diagnostics/assessment
> quietly nbreg dv `ss_lag_1_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr
> */
. predict cssv2_yhat 
(option n assumed; predicted number of events)

. gen cssv2_res = dv - cssv2_yhat

. 
. summ dv cssv2_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          dv |      6,253    1.881017    3.268911          0         37
  cssv2_yhat |      6,253      1.9103    2.823789    .000644   38.61359

. /*
> pause "next"
> 
> scatter dv cssv2_yhat
> 
> pause "next"
> 
> scatter cssv2_res dv
> 
> pause "next"
> 
> scatter cssv2_res cssv2_yhat
> */
. pause "complete: C.SSV.2"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model C.SSV.3
. 
. // poisson model
. /*
> glm dv `ss_lag_4_vars' `covariates' ib(freq).state ib(freq).time, family(poisson) link(log) vce(cl mineid) exposure(hours) iter(50) eform
>         
> quietly poisson dv `ss_lag_4_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr
> est store pois
> estat gof
>         
> pause "next"
> 
> // negative binomial model
> glm dv `ss_lag_4_vars' `covariates' ib(freq).state ib(freq).time, family(nbinomial) link(log) vce(cl mineid) exposure(hours) iter(50) eform
> 
> pause "next"
> */
. eststo clear

. eststo: nbreg dv `ss_lag_4_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr

Fitting Poisson model:

Iteration 0:   log pseudolikelihood =  -10627.69  
Iteration 1:   log pseudolikelihood = -8977.4639  
Iteration 2:   log pseudolikelihood = -8966.7827  
Iteration 3:   log pseudolikelihood = -8966.7723  
Iteration 4:   log pseudolikelihood = -8966.7723  

Fitting constant-only model:

Iteration 0:   log pseudolikelihood = -9249.9658  
Iteration 1:   log pseudolikelihood = -8971.6355  
Iteration 2:   log pseudolikelihood =  -8961.958  
Iteration 3:   log pseudolikelihood = -8961.9317  
Iteration 4:   log pseudolikelihood = -8961.9317  

Fitting full model:

Iteration 0:   log pseudolikelihood = -8703.6041  
Iteration 1:   log pseudolikelihood = -8667.1679  
Iteration 2:   log pseudolikelihood = -8666.3158  
Iteration 3:   log pseudolikelihood = -8666.3154  

Negative binomial regression                    Number of obs     =      6,253
                                                Wald chi2(36)     =          .
Dispersion           = mean                     Prob > chi2       =          .
Log pseudolikelihood = -8666.3154               Pseudo R2         =     0.0330

                                  (Std. Err. adjusted for 1,238 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
               dv |        IRR   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
    p47_ss_c_4lag |   .9724124    .095234    -0.29   0.775     .8025783    1.178185
    p48_ss_c_4lag |   1.002528   .0085747     0.30   0.768     .9858617    1.019475
    p71_ss_c_4lag |   .9336707   .0450946    -1.42   0.155     .8493412    1.026373
    p72_ss_c_4lag |   .9838469   .0270415    -0.59   0.554     .9322488    1.038301
    p75_ss_c_4lag |   1.000872   .0002215     3.94   0.000     1.000438    1.001307
    p77_ss_c_4lag |   1.004702   .0055563     0.85   0.396     .9938711    1.015652
        mine_time |    .994881   .0072099    -0.71   0.479     .9808497    1.009113
onsite_insp_hours |   .9999212   .0000461    -1.71   0.088     .9998307    1.000012
         longwall |   .8322866   .0649798    -2.35   0.019     .7141942    .9699056
                  |
            state |
               1  |   1.125455   .1125644     1.18   0.237     .9251103    1.369186
               2  |   1.808615   .0994778    10.77   0.000     1.623784    2.014485
               3  |   .8175282   .1417678    -1.16   0.245     .5819633    1.148444
               4  |   1.154873    .109354     1.52   0.128     .9592567    1.390381
               5  |   .8908648   .1430996    -0.72   0.472     .6502544    1.220507
               6  |   .9170959   .0461513    -1.72   0.085     .8309588    1.012162
               7  |   .9438271    .218728    -0.25   0.803     .5992804    1.486465
               8  |   1.083462   .0731008     1.19   0.235     .9492561    1.236642
               9  |   .8602545   .0596684    -2.17   0.030     .7509076    .9855246
              10  |   1.026203   .1709037     0.16   0.877     .7404139    1.422304
              11  |   .8456455   .2107966    -0.67   0.501     .5188082    1.378383
              12  |   .9684119   .0818739    -0.38   0.704     .8205324    1.142943
              13  |    1.29548   .1941853     1.73   0.084     .9656959    1.737886
              14  |   .6879277   .0955465    -2.69   0.007     .5239854    .9031637
              15  |   .6567585   .0488119    -5.66   0.000     .5677306    .7597472
              17  |    1.22487   .0921427     2.70   0.007     1.056956    1.419459
                  |
             time |
            2000  |   1.155848   .0710107     2.36   0.018     1.024723    1.303753
            2002  |   .9811862   .0583273    -0.32   0.749     .8732752    1.102432
            2003  |   .8794214   .0565074    -2.00   0.046     .7753591      .99745
            2004  |   .8807309   .0585969    -1.91   0.056      .773056    1.003403
            2005  |    .767329   .0497513    -4.08   0.000     .6757597    .8713065
            2006  |   .7617454   .0547535    -3.79   0.000     .6616471    .8769874
            2007  |   .7067281   .0519461    -4.72   0.000     .6119095    .8162395
            2008  |    .641102   .0475029    -6.00   0.000     .5544428    .7413061
            2009  |    .550245   .0435314    -7.55   0.000     .4712107    .6425354
            2010  |   .5621626   .0458957    -7.05   0.000     .4790365    .6597133
            2011  |   .5957317   .0494966    -6.23   0.000     .5062072    .7010888
            2012  |   .6138312   .0520268    -5.76   0.000     .5198802    .7247607
            2013  |   .5391873   .0505249    -6.59   0.000      .448722    .6478911
            2014  |   .5229127   .0493669    -6.87   0.000     .4345796    .6292006
            2015  |   .5514304   .0575029    -5.71   0.000      .449498     .676478
                  |
            _cons |   .0000168   1.00e-06  -183.78   0.000     .0000149    .0000188
        ln(hours) |          1  (exposure)
------------------+----------------------------------------------------------------
         /lnalpha |  -1.536193   .0967524                     -1.725824   -1.346561
------------------+----------------------------------------------------------------
            alpha |   .2151989    .020821                      .1780263    .2601332
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.C.SSV.3.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.SSV.3.csv not fo
> und)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.SSV.3.csv
> )

. /*
> est store nbin
> 
> pause "next"
> 
> // test for over-dispersion
> lrtest pois nbin, stats force 
> 
> pause "next" 
> 
> // final model + diagnostics/assessment
> quietly nbreg dv `ss_lag_4_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr
> */
. predict cssv3_yhat 
(option n assumed; predicted number of events)

. gen cssv3_res = dv - cssv3_yhat

. 
. summ dv cssv3_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          dv |      6,253    1.881017    3.268911          0         37
  cssv3_yhat |      6,253    1.909488    2.815846   .0006466   37.79595

. /*
> pause "next"
> 
> scatter dv cssv3_yhat
> 
> pause "next"
> 
> scatter cssv3_res dv
> 
> pause "next"
> 
> scatter cssv3_res cssv3_yhat
> */
. pause "complete: C.SSV.3"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model C.SSV.4
. 
. // poisson model
. /*
> glm dv `ss_lag_all_vars' `covariates' ib(freq).state ib(freq).time, family(poisson) link(log) vce(cl mineid) exposure(hours) iter(50) eform
>         
> quietly poisson dv `ss_lag_all_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr
> est store pois
> estat gof
>         
> pause "next"
> 
> // negative binomial model
> glm dv `ss_lag_all_vars' `covariates' ib(freq).state ib(freq).time, family(nbinomial) link(log) vce(cl mineid) exposure(hours) iter(50) eform
> 
> pause "next"
> */
. eststo clear

. eststo: nbreg dv `ss_lag_all_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr

Fitting Poisson model:

Iteration 0:   log pseudolikelihood = -10679.209  
Iteration 1:   log pseudolikelihood = -8991.9959  
Iteration 2:   log pseudolikelihood = -8982.2039  
Iteration 3:   log pseudolikelihood = -8982.1948  
Iteration 4:   log pseudolikelihood = -8982.1948  

Fitting constant-only model:

Iteration 0:   log pseudolikelihood = -9249.9658  
Iteration 1:   log pseudolikelihood = -8971.6355  
Iteration 2:   log pseudolikelihood =  -8961.958  
Iteration 3:   log pseudolikelihood = -8961.9317  
Iteration 4:   log pseudolikelihood = -8961.9317  

Fitting full model:

Iteration 0:   log pseudolikelihood =  -8711.716  
Iteration 1:   log pseudolikelihood = -8678.7207  
Iteration 2:   log pseudolikelihood = -8678.0519  
Iteration 3:   log pseudolikelihood = -8678.0516  

Negative binomial regression                    Number of obs     =      6,253
                                                Wald chi2(36)     =          .
Dispersion           = mean                     Prob > chi2       =          .
Log pseudolikelihood = -8678.0516               Pseudo R2         =     0.0317

                                  (Std. Err. adjusted for 1,238 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
               dv |        IRR   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
 p47_ss_c_lag_all |   .9876638   .0359542    -0.34   0.733     .9196501    1.060708
 p48_ss_c_lag_all |   1.005071   .0039692     1.28   0.200     .9973217    1.012881
 p71_ss_c_lag_all |   .9831527   .0221761    -0.75   0.451     .9406351    1.027592
 p72_ss_c_lag_all |   .9981629   .0115586    -0.16   0.874     .9757637    1.021076
 p75_ss_c_lag_all |   1.000033   .0000417     0.79   0.432      .999951    1.000115
 p77_ss_c_lag_all |    1.00193   .0017564     1.10   0.271     .9984934    1.005378
        mine_time |   .9896125   .0079074    -1.31   0.191     .9742351    1.005233
onsite_insp_hours |   .9999705   .0000396    -0.75   0.456     .9998928    1.000048
         longwall |   .8306749   .0639969    -2.41   0.016     .7142542    .9660717
                  |
            state |
               1  |   1.092028   .1050876     0.91   0.360     .9043187    1.318701
               2  |   1.941033   .1062911    12.11   0.000     1.743496     2.16095
               3  |   .7823626   .1474552    -1.30   0.193     .5407276    1.131977
               4  |   1.121588   .0954455     1.35   0.178     .9492862    1.325163
               5  |   .8425007   .1361162    -1.06   0.289     .6138303    1.156358
               6  |   .9053682   .0467211    -1.93   0.054     .8182751    1.001731
               7  |   .9659835   .2161324    -0.15   0.877     .6230444    1.497685
               8  |   1.075256   .0806289     0.97   0.333     .9282905    1.245489
               9  |   .8357618   .0605929    -2.47   0.013     .7250538    .9633738
              10  |   .9565651    .162367    -0.26   0.794     .6858544    1.334127
              11  |   .8452972   .1969976    -0.72   0.471     .5353475    1.334698
              12  |   .9486987   .0783831    -0.64   0.524     .8068644    1.115465
              13  |   1.263895   .1910508     1.55   0.121     .9398169    1.699726
              14  |   .6746564   .0950174    -2.79   0.005     .5119186    .8891281
              15  |   .6526691   .0492757    -5.65   0.000     .5628963    .7567591
              17  |   1.092911   .1029807     0.94   0.346     .9086142     1.31459
                  |
             time |
            2000  |   1.087199   .0644096     1.41   0.158     .9680126    1.221061
            2002  |   .9784954   .0578282    -0.37   0.713     .8714723    1.098662
            2003  |   .8729812   .0554627    -2.14   0.033     .7707721    .9887439
            2004  |      .8766    .057271    -2.02   0.044     .7712405    .9963527
            2005  |   .7657644   .0487815    -4.19   0.000     .6758822    .8675996
            2006  |   .7676246   .0538305    -3.77   0.000     .6690483    .8807251
            2007  |   .7119971   .0520546    -4.65   0.000     .6169448     .821694
            2008  |    .635205   .0464621    -6.20   0.000     .5503675      .73312
            2009  |   .5402447   .0428043    -7.77   0.000     .4625394    .6310042
            2010  |     .54317   .0444562    -7.46   0.000     .4626669    .6376805
            2011  |   .5731655   .0471308    -6.77   0.000     .4878503    .6734005
            2012  |   .5800707   .0490326    -6.44   0.000     .4915072    .6845921
            2013  |   .5059835   .0470443    -7.33   0.000     .4216918    .6071244
            2014  |   .4904002    .046437    -7.52   0.000      .407332    .5904087
            2015  |    .511707   .0525008    -6.53   0.000     .4184934    .6256826
                  |
            _cons |    .000018   1.10e-06  -178.92   0.000      .000016    .0000203
        ln(hours) |          1  (exposure)
------------------+----------------------------------------------------------------
         /lnalpha |  -1.524695   .0948986                     -1.710693   -1.338698
------------------+----------------------------------------------------------------
            alpha |   .2176874   .0206582                      .1807405    .2621869
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.C.SSV.4.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.SSV.4.csv not fo
> und)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.SSV.4.csv
> )

. /*
> est store nbin
> 
> pause "next"
> 
> // test for over-dispersion
> lrtest pois nbin, stats force 
> 
> pause "next" 
> 
> // final model + diagnostics/assessment
> quietly nbreg dv `ss_lag_all_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) exposure(hours) iter(50) irr
> */
. predict cssv4_yhat 
(option n assumed; predicted number of events)

. gen cssv4_res = dv - cssv4_yhat

. 
. summ dv cssv4_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          dv |      6,253    1.881017    3.268911          0         37
  cssv4_yhat |      6,253    1.901682     2.74749   .0006496   22.49113

. /*
> pause "next"
> 
> scatter dv cssv4_yhat
> 
> pause "next"
> 
> scatter cssv4_res dv
> 
> pause "next"
> 
> scatter cssv4_res cssv4_yhat
> */
. pause "complete: C.SSV.4"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model C.PP.1
. 
. // poisson model
. /*
> glm dv `pp_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, family(poisson) link(log) vce(cl mineid) exposure(hours) iter(50) eform
>         
> quietly poisson dv `pp_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, vce(cl mineid) exposure(hours) iter(50) irr
> est store pois
> estat gof
>         
> pause "next"
> 
> // negative binomial model
> glm dv `pp_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, family(nbinomial) link(log) vce(cl mineid) exposure(hours) iter(50) eform
> 
> pause "next"
> */
. eststo clear

. eststo: nbreg dv `pp_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, vce(cl mineid) exposure(hours) iter(50) irr

Fitting Poisson model:

Iteration 0:   log pseudolikelihood = -5250.6596  
Iteration 1:   log pseudolikelihood = -4698.1479  
Iteration 2:   log pseudolikelihood = -4689.3563  
Iteration 3:   log pseudolikelihood = -4689.3163  
Iteration 4:   log pseudolikelihood = -4689.3163  

Fitting constant-only model:

Iteration 0:   log pseudolikelihood = -4833.1956  
Iteration 1:   log pseudolikelihood = -4642.8135  
Iteration 2:   log pseudolikelihood =  -4639.576  
Iteration 3:   log pseudolikelihood =   -4639.57  
Iteration 4:   log pseudolikelihood =   -4639.57  

Fitting full model:

Iteration 0:   log pseudolikelihood = -4561.1406  
Iteration 1:   log pseudolikelihood = -4549.5107  
Iteration 2:   log pseudolikelihood = -4549.4023  
Iteration 3:   log pseudolikelihood = -4549.4022  

Negative binomial regression                    Number of obs     =      3,333
                                                Wald chi2(29)     =          .
Dispersion           = mean                     Prob > chi2       =          .
Log pseudolikelihood = -4549.4022               Pseudo R2         =     0.0194

                                    (Std. Err. adjusted for 727 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
               dv |        IRR   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
           p47_pp |   .9985412   .0011125    -1.31   0.190     .9963631    1.000724
           p48_pp |   1.000195   .0001571     1.24   0.215     .9998869    1.000503
           p71_pp |    1.00039   .0006143     0.63   0.526     .9991865    1.001594
           p72_pp |   .9992913   .0005008    -1.41   0.157     .9983102    1.000273
           p75_pp |   1.000017   4.43e-06     3.83   0.000     1.000008    1.000026
           p77_pp |   .9999665   .0001286    -0.26   0.794     .9997144    1.000219
        mine_time |   .9900837   .0079852    -1.24   0.217     .9745559    1.005859
onsite_insp_hours |   .9998483   .0000592    -2.56   0.010     .9997322    .9999644
         longwall |    .980017   .1024111    -0.19   0.847      .798516    1.202773
                  |
            state |
               1  |   1.357405   .1984695     2.09   0.037     1.019185    1.807864
               2  |   2.230617   .1524656    11.74   0.000     1.950942    2.550385
               3  |   .7403784   .1269412    -1.75   0.080      .529068    1.036087
               4  |   1.178799    .109552     1.77   0.077     .9825015    1.414316
               5  |    .970805   .1981949    -0.15   0.885      .650661    1.448469
               6  |   1.019054    .064413     0.30   0.765     .9003136    1.153454
               7  |   1.161034   .2293998     0.76   0.450     .7882478    1.710123
               8  |    .837143   .0871777    -1.71   0.088     .6825868    1.026695
               9  |   .8359834   .0877179    -1.71   0.088     .6805858    1.026863
              10  |   .9006071   .1573883    -0.60   0.549     .6394125    1.268498
              11  |    .835249   .4017613    -0.37   0.708     .3253729    2.144127
              12  |   .9730879   .1228224    -0.22   0.829     .7598259    1.246207
              13  |   1.224321   .2069572     1.20   0.231     .8790419    1.705222
              14  |   .6861268    .149634    -1.73   0.084     .4474764    1.052056
              15  |   .6839288   .0610513    -4.26   0.000     .5741533    .8146928
              17  |   1.087038     .11322     0.80   0.423     .8863148    1.333218
                  |
             time |
            2007  |   1.131244   .0708211     1.97   0.049     1.000615    1.278926
            2009  |   .8661405   .0521549    -2.39   0.017     .7697205    .9746387
            2010  |    .889883   .0578173    -1.80   0.073     .7834816    1.010734
            2011  |   .9475568   .0567876    -0.90   0.369     .8425434    1.065659
            2012  |   .9706476   .0624823    -0.46   0.644      .855595    1.101171
            2013  |   .8613455   .0639282    -2.01   0.044     .7447355     .996214
            2014  |   .8320157   .0643987    -2.38   0.018     .7149042    .9683117
            2015  |   .8809134   .0702804    -1.59   0.112     .7533958    1.030014
                  |
            _cons |   .0000106   7.65e-07  -158.80   0.000     9.21e-06    .0000122
        ln(hours) |          1  (exposure)
------------------+----------------------------------------------------------------
         /lnalpha |  -1.609452   .1202472                     -1.845132   -1.373771
------------------+----------------------------------------------------------------
            alpha |   .1999973   .0240491                      .1580045    .2531504
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.C.PP.1.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.PP.1.csv not fou
> nd)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.PP.1.csv)

. /*
> est store nbin
> 
> pause "next"
> 
> // test for over-dispersion
> lrtest pois nbin, stats force 
> 
> pause "next" 
> 
> // final model + diagnostics/assessment
> quietly nbreg dv `pp_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, vce(cl mineid) exposure(hours) iter(50) irr
> */
. predict cpp1_yhat 
(option n assumed; predicted number of events)

. gen cpp1_res = dv - cpp1_yhat

. 
. summ dv cpp1_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          dv |      6,253    1.881017    3.268911          0         37
   cpp1_yhat |      6,253     1.60273     2.39325   .0006506   29.87707

. /*
> pause "next"
> 
> scatter dv cpp1_yhat
> 
> pause "next"
> 
> scatter cpp1_res dv
> 
> pause "next"
> 
> scatter cpp1_res cpp1_yhat
> */
. pause "complete: C.PP.1"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model C.PP.2
. 
. // poisson model
. /*
> glm dv `pp_lag_1_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, family(poisson) link(log) vce(cl mineid) exposure(hours) iter(50) eform
>         
> quietly poisson dv `pp_lag_1_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, vce(cl mineid) exposure(hours) iter(50) irr
> est store pois
> estat gof
>         
> pause "next"
> 
> // negative binomial model
> glm dv `pp_lag_1_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, family(nbinomial) link(log) vce(cl mineid) exposure(hours) iter(50) eform
> 
> pause "next"
> */
. eststo clear

. eststo: nbreg dv `pp_lag_1_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, vce(cl mineid) exposure(hours) iter(50) irr

Fitting Poisson model:

Iteration 0:   log pseudolikelihood = -5216.0755  
Iteration 1:   log pseudolikelihood = -4700.3606  
Iteration 2:   log pseudolikelihood = -4692.6748  
Iteration 3:   log pseudolikelihood =  -4692.662  
Iteration 4:   log pseudolikelihood =  -4692.662  

Fitting constant-only model:

Iteration 0:   log pseudolikelihood = -4833.1956  
Iteration 1:   log pseudolikelihood = -4642.8135  
Iteration 2:   log pseudolikelihood =  -4639.576  
Iteration 3:   log pseudolikelihood =   -4639.57  
Iteration 4:   log pseudolikelihood =   -4639.57  

Fitting full model:

Iteration 0:   log pseudolikelihood = -4562.1449  
Iteration 1:   log pseudolikelihood = -4550.6052  
Iteration 2:   log pseudolikelihood = -4550.4983  
Iteration 3:   log pseudolikelihood = -4550.4983  

Negative binomial regression                    Number of obs     =      3,333
                                                Wald chi2(29)     =          .
Dispersion           = mean                     Prob > chi2       =          .
Log pseudolikelihood = -4550.4983               Pseudo R2         =     0.0192

                                    (Std. Err. adjusted for 727 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
               dv |        IRR   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
      p47_pp_1lag |    .998484   .0008876    -1.71   0.088     .9967458    1.000225
      p48_pp_1lag |   1.000175   .0001456     1.20   0.229     .9998897     1.00046
      p71_pp_1lag |    .999931   .0008795    -0.08   0.937     .9982086    1.001656
      p72_pp_1lag |   .9994469    .000542    -1.02   0.308     .9983852     1.00051
      p75_pp_1lag |   1.000016   4.41e-06     3.71   0.000     1.000008    1.000025
      p77_pp_1lag |    .999981   .0001114    -0.17   0.864     .9997627    1.000199
        mine_time |   .9895063   .0079059    -1.32   0.187     .9741317    1.005124
onsite_insp_hours |   .9998559   .0000575    -2.51   0.012     .9997433    .9999686
         longwall |   .9822125   .1017966    -0.17   0.863     .8016538    1.203439
                  |
            state |
               1  |   1.344023   .1970146     2.02   0.044       1.0084    1.791351
               2  |    2.22529   .1485479    11.98   0.000     1.952384    2.536344
               3  |   .7294148   .1218894    -1.89   0.059      .525695    1.012081
               4  |   1.175088   .1072578     1.77   0.077     .9825977    1.405287
               5  |   .9673514   .1960529    -0.16   0.870     .6502367     1.43912
               6  |   1.014097   .0639753     0.22   0.824     .8961495    1.147568
               7  |   1.154865   .2279283     0.73   0.466     .7843957    1.700307
               8  |   .8178148   .0837005    -1.97   0.049     .6691716    .9994763
               9  |   .8425627   .0926596    -1.56   0.119      .679192     1.04523
              10  |    .900511   .1577324    -0.60   0.550     .6388422    1.269359
              11  |   .8316607   .3966023    -0.39   0.699     .3266068    2.117713
              12  |   .9660406   .1219205    -0.27   0.784      .754342     1.23715
              13  |   1.224052   .2082215     1.19   0.235     .8770079    1.708427
              14  |   .6771792   .1478244    -1.79   0.074     .4414597    1.038762
              15  |   .6792936   .0612063    -4.29   0.000      .569327    .8105005
              17  |   1.076067   .1101885     0.72   0.474      .880394    1.315231
                  |
             time |
            2007  |   1.164616   .0741254     2.39   0.017     1.028029    1.319349
            2009  |   .8585922   .0520631    -2.51   0.012     .7623809    .9669453
            2010  |   .8860542   .0579385    -1.85   0.064     .7794724    1.007209
            2011  |   .9476351   .0572321    -0.89   0.373     .8418468    1.066717
            2012  |   .9635701   .0626329    -0.57   0.568     .8483097    1.094491
            2013  |   .8515227   .0635064    -2.16   0.031      .735722    .9855501
            2014  |   .8307658   .0645625    -2.39   0.017     .7133916    .9674515
            2015  |   .8740391   .0700488    -1.68   0.093     .7469859    1.022702
                  |
            _cons |   .0000107   7.77e-07  -157.49   0.000     9.27e-06    .0000123
        ln(hours) |          1  (exposure)
------------------+----------------------------------------------------------------
         /lnalpha |  -1.607555   .1201928                     -1.843128   -1.371981
------------------+----------------------------------------------------------------
            alpha |    .200377   .0240839                      .1583214    .2536041
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.C.PP.2.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.PP.2.csv not fou
> nd)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.PP.2.csv)

. /*
> est store nbin
> 
> pause "next"
> 
> // test for over-dispersion
> lrtest pois nbin, stats force 
> 
> pause "next" 
> 
> // final model + diagnostics/assessment
> quietly nbreg dv `pp_lag_1_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, vce(cl mineid) exposure(hours) iter(50) irr
> */
. predict cpp2_yhat 
(option n assumed; predicted number of events)

. gen cpp2_res = dv - cpp2_yhat

. 
. summ dv cpp2_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          dv |      6,253    1.881017    3.268911          0         37
   cpp2_yhat |      6,253    1.605611    2.388947   .0006479   30.25038

. /*
> pause "next"
> 
> scatter dv cpp2_yhat
> 
> pause "next"
> 
> scatter cpp2_res dv
> 
> pause "next"
> 
> scatter cpp2_res cpp2_yhat
> */
. pause "complete: C.PP.2"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model C.PP.3
. 
. // poisson model
. /*
> glm dv `pp_lag_4_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, family(poisson) link(log) vce(cl mineid) exposure(hours) iter(50) eform
>         
> quietly poisson dv `pp_lag_4_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, vce(cl mineid) exposure(hours) iter(50) irr
> est store pois
> estat gof
>         
> pause "next"
> 
> // negative binomial model
> glm dv `pp_lag_4_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, family(nbinomial) link(log) vce(cl mineid) exposure(hours) iter(50) eform
> 
> pause "next"
> */
. eststo clear

. eststo: nbreg dv `pp_lag_4_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, vce(cl mineid) exposure(hours) iter(50) irr

Fitting Poisson model:

Iteration 0:   log pseudolikelihood = -5243.5249  
Iteration 1:   log pseudolikelihood =   -4699.54  
Iteration 2:   log pseudolikelihood = -4691.7142  
Iteration 3:   log pseudolikelihood = -4691.7017  
Iteration 4:   log pseudolikelihood = -4691.7017  

Fitting constant-only model:

Iteration 0:   log pseudolikelihood = -4833.1956  
Iteration 1:   log pseudolikelihood = -4642.8135  
Iteration 2:   log pseudolikelihood =  -4639.576  
Iteration 3:   log pseudolikelihood =   -4639.57  
Iteration 4:   log pseudolikelihood =   -4639.57  

Fitting full model:

Iteration 0:   log pseudolikelihood = -4563.0665  
Iteration 1:   log pseudolikelihood = -4551.3231  
Iteration 2:   log pseudolikelihood =  -4551.212  
Iteration 3:   log pseudolikelihood =  -4551.212  

Negative binomial regression                    Number of obs     =      3,333
                                                Wald chi2(29)     =          .
Dispersion           = mean                     Prob > chi2       =          .
Log pseudolikelihood =  -4551.212               Pseudo R2         =     0.0190

                                    (Std. Err. adjusted for 727 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
               dv |        IRR   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
    p47_pp_c_4lag |   .9994418   .0003229    -1.73   0.084     .9988091    1.000075
    p48_pp_c_4lag |   1.000065   .0000573     1.13   0.258     .9999525    1.000177
    p71_pp_c_4lag |   .9997791   .0003184    -0.69   0.488     .9991553    1.000403
    p72_pp_c_4lag |   .9998631   .0001578    -0.87   0.386     .9995539    1.000172
    p75_pp_c_4lag |   1.000004   1.17e-06     3.40   0.001     1.000002    1.000006
    p77_pp_c_4lag |   .9999961   .0000352    -0.11   0.913     .9999271    1.000065
        mine_time |    .989258   .0078815    -1.36   0.175     .9739306    1.004827
onsite_insp_hours |   .9998594   .0000576    -2.44   0.015     .9997464    .9999724
         longwall |   .9894118    .101893    -0.10   0.918     .8085697      1.2107
                  |
            state |
               1  |   1.327844   .1947347     1.93   0.053     .9961261    1.770027
               2  |   2.237935   .1488017    12.12   0.000     1.964493    2.549438
               3  |   .7244196   .1213406    -1.92   0.054     .5216913    1.005928
               4  |   1.174347   .1058805     1.78   0.075     .9841265    1.401334
               5  |   .9647863   .1958415    -0.18   0.860     .6481061    1.436204
               6  |   1.014282   .0640933     0.22   0.822     .8961295    1.148013
               7  |   1.153878   .2265355     0.73   0.466     .7853214      1.6954
               8  |   .8084379     .08344    -2.06   0.039     .6603786    .9896926
               9  |   .8566866   .0953502    -1.39   0.165     .6887828     1.06552
              10  |   .8996156   .1573145    -0.60   0.545     .6385701    1.267376
              11  |   .8318387   .3953779    -0.39   0.698     .3276861    2.111642
              12  |   .9608193   .1210031    -0.32   0.751     .7506606    1.229815
              13  |   1.232264    .209892     1.23   0.220     .8825072    1.720637
              14  |   .6707348   .1470415    -1.82   0.068     .4364622    1.030754
              15  |   .6763516   .0613583    -4.31   0.000     .5661767     .807966
              17  |   1.068517   .1096962     0.65   0.519     .8737667    1.306676
                  |
             time |
            2007  |   1.164393   .0744162     2.38   0.017     1.027305    1.319775
            2009  |   .8542616   .0515829    -2.61   0.009     .7589145    .9615879
            2010  |   .8825726   .0576638    -1.91   0.056     .7764907    1.003147
            2011  |    .940594   .0563459    -1.02   0.307     .8363947    1.057775
            2012  |   .9563409   .0619546    -0.69   0.491      .842305    1.085816
            2013  |   .8441996   .0620983    -2.30   0.021     .7308559    .9751211
            2014  |   .8233198   .0643684    -2.49   0.013     .7063506    .9596587
            2015  |   .8663029   .0685147    -1.81   0.070     .7419069    1.011556
                  |
            _cons |   .0000108   7.78e-07  -158.91   0.000     9.39e-06    .0000125
        ln(hours) |          1  (exposure)
------------------+----------------------------------------------------------------
         /lnalpha |   -1.61019   .1211442                     -1.847628   -1.372751
------------------+----------------------------------------------------------------
            alpha |   .1998497   .0242106                      .1576106    .2534088
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.C.PP.3.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.PP.3.csv not fou
> nd)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.PP.3.csv)

. /*
> est store nbin
> 
> pause "next"
> 
> // test for over-dispersion
> lrtest pois nbin, stats force 
> 
> pause "next" 
> 
> // final model + diagnostics/assessment
> quietly nbreg dv `pp_lag_4_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, vce(cl mineid) exposure(hours) iter(50) irr
> */
. predict cpp3_yhat 
(option n assumed; predicted number of events)

. gen cpp3_res = dv - cpp3_yhat

. 
. summ dv cpp3_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          dv |      6,253    1.881017    3.268911          0         37
   cpp3_yhat |      6,253    1.612416    2.396944   .0006495   30.43889

. /*
> pause "next"
> 
> scatter dv cpp3_yhat
> 
> pause "next"
> 
> scatter cpp3_res dv
> 
> pause "next"
> 
> scatter cpp3_res cpp3_yhat
> */
. pause "complete: C.PP.3"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model C.PP.4
. 
. // poisson model
. /*
> glm dv `pp_lag_all_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, family(poisson) link(log) vce(cl mineid) exposure(hours) iter(50) eform
>         
> quietly poisson dv `pp_lag_all_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, vce(cl mineid) exposure(hours) iter(50) irr
> est store pois
> estat gof
>         
> pause "next"
> 
> // negative binomial model
> glm dv `pp_lag_all_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, family(nbinomial) link(log) vce(cl mineid) exposure(hours) iter(50) eform
> 
> pause "next"
> */ 
. eststo clear

. eststo: nbreg dv `pp_lag_all_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, vce(cl mineid) exposure(hours) iter(50) irr

Fitting Poisson model:

Iteration 0:   log pseudolikelihood =  -6075.996  
Iteration 1:   log pseudolikelihood = -4724.0865  
Iteration 2:   log pseudolikelihood = -4704.4733  
Iteration 3:   log pseudolikelihood = -4704.3062  
Iteration 4:   log pseudolikelihood = -4704.3062  

Fitting constant-only model:

Iteration 0:   log pseudolikelihood = -4833.1956  
Iteration 1:   log pseudolikelihood = -4642.8135  
Iteration 2:   log pseudolikelihood =  -4639.576  
Iteration 3:   log pseudolikelihood =   -4639.57  
Iteration 4:   log pseudolikelihood =   -4639.57  

Fitting full model:

Iteration 0:   log pseudolikelihood = -4569.7666  
Iteration 1:   log pseudolikelihood = -4559.2841  
Iteration 2:   log pseudolikelihood = -4559.1972  
Iteration 3:   log pseudolikelihood = -4559.1972  

Negative binomial regression                    Number of obs     =      3,333
                                                Wald chi2(29)     =          .
Dispersion           = mean                     Prob > chi2       =          .
Log pseudolikelihood = -4559.1972               Pseudo R2         =     0.0173

                                    (Std. Err. adjusted for 727 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
               dv |        IRR   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
 p47_pp_c_lag_all |   .9999205   .0002042    -0.39   0.697     .9995204    1.000321
 p48_pp_c_lag_all |   1.000024   .0000205     1.19   0.232     .9999843    1.000065
 p71_pp_c_lag_all |   .9999513   .0001747    -0.28   0.781      .999609    1.000294
 p72_pp_c_lag_all |   .9999906   .0000758    -0.12   0.901     .9998421    1.000139
 p75_pp_c_lag_all |          1   2.28e-07     1.86   0.062            1    1.000001
 p77_pp_c_lag_all |   1.000001   .0000123     0.10   0.920     .9999772    1.000025
        mine_time |   .9850287   .0084706    -1.75   0.079     .9685657    1.001772
onsite_insp_hours |   .9999185   .0000445    -1.83   0.067     .9998313    1.000006
         longwall |   .9634628   .1015301    -0.35   0.724     .7836732      1.1845
                  |
            state |
               1  |   1.229964   .1858949     1.37   0.171     .9146255    1.654024
               2  |   2.278998   .1558823    12.04   0.000     1.993068    2.605947
               3  |   .7014609   .1255204    -1.98   0.048      .493956     .996136
               4  |   1.165246   .1030213     1.73   0.084     .9798544    1.385715
               5  |   .9093514    .184084    -0.47   0.639     .6115321     1.35221
               6  |   .9789455   .0622436    -0.33   0.738     .8642455    1.108868
               7  |   1.160669   .2181214     0.79   0.428     .8030529    1.677538
               8  |   .7985477   .0910261    -1.97   0.048     .6386645    .9984562
               9  |   .8329325   .1236741    -1.23   0.218     .6226201    1.114286
              10  |   .8809881     .15377    -0.73   0.468     .6257474    1.240341
              11  |   .8302581   .3906147    -0.40   0.693     .3301757    2.087763
              12  |   .8909798   .1120744    -0.92   0.359     .6963011    1.140089
              13  |    1.17523   .2057718     0.92   0.356     .8338451    1.656381
              14  |     .65522   .1473593    -1.88   0.060     .4216493    1.018176
              15  |   .6629696   .0625659    -4.36   0.000     .5510156    .7976702
              17  |   .9908309   .1167446    -0.08   0.938     .7865145    1.248223
                  |
             time |
            2007  |   1.106267   .0670963     1.67   0.096     .9822762    1.245909
            2009  |    .848567   .0503408    -2.77   0.006     .7554209    .9531983
            2010  |   .8517788   .0566223    -2.41   0.016     .7477268    .9703106
            2011  |   .8932301   .0539607    -1.87   0.062     .7934903    1.005507
            2012  |   .9002177   .0608435    -1.56   0.120     .7885277    1.027728
            2013  |   .7817445   .0585495    -3.29   0.001     .6750149    .9053498
            2014  |   .7540038   .0587284    -3.63   0.000     .6472536    .8783601
            2015  |    .778571   .0643913    -3.03   0.002     .6620641    .9155803
                  |
            _cons |    .000012   8.91e-07  -152.35   0.000     .0000104    .0000139
        ln(hours) |          1  (exposure)
------------------+----------------------------------------------------------------
         /lnalpha |   -1.59263   .1193862                     -1.826623   -1.358638
------------------+----------------------------------------------------------------
            alpha |   .2033899    .024282                      .1609562    .2570107
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.C.PP.4.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.PP.4.csv not fou
> nd)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.C.PP.4.csv)

. /*
> est store nbin
> 
> pause "next"
> 
> // test for over-dispersion
> lrtest pois nbin, stats force 
> 
> pause "next"
> 
> // final model + diagnostics/assessment
> quietly nbreg dv `pp_lag_all_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, vce(cl mineid) exposure(hours) iter(50) irr
> */
. predict cpp4_yhat 
(option n assumed; predicted number of events)

. gen cpp4_res = dv - cpp4_yhat

. 
. summ dv cpp4_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          dv |      6,253    1.881017    3.268911          0         37
   cpp4_yhat |      6,253    1.664403    2.426349   .0006641   22.39887

. /*
> pause "next"
> 
> scatter dv cpp4_yhat
> 
> pause "next"
> 
> scatter cpp4_res dv
> 
> pause "next"
> 
> scatter cpp4_res cpp4_yhat
> */
. pause "complete: C.PP.4"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model B.V.1
. 
. eststo clear

. eststo: logit dv_indicator `count_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) offset(lnhours) iter(50) or

note: 17.state != 0 predicts success perfectly
      17.state dropped and 11 obs not used

Iteration 0:   log pseudolikelihood = -3080.1072  
Iteration 1:   log pseudolikelihood = -2912.2883  
Iteration 2:   log pseudolikelihood = -2900.3405  
Iteration 3:   log pseudolikelihood = -2900.2196  
Iteration 4:   log pseudolikelihood = -2900.2196  

Logistic regression                             Number of obs     =      6,242
                                                Wald chi2(36)     =          .
Log pseudolikelihood = -2900.2196               Prob > chi2       =          .

                                  (Std. Err. adjusted for 1,237 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
     dv_indicator | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
              p47 |   .9146369   .1258102    -0.65   0.517     .6984963    1.197659
              p48 |   1.060399   .0443442     1.40   0.161     .9769527    1.150973
              p71 |   1.354316   .2536509     1.62   0.105     .9382055     1.95498
              p72 |   1.148043   .1546109     1.03   0.305     .8817062    1.494832
              p75 |   1.005613   .0014327     3.93   0.000     1.002809    1.008425
              p77 |   1.032296   .0182994     1.79   0.073     .9970456    1.068792
        mine_time |   .9991414   .0139216    -0.06   0.951     .9722247    1.026803
onsite_insp_hours |   1.000703   .0002025     3.47   0.001     1.000306      1.0011
         longwall |   .9534505   .2803922    -0.16   0.871     .5357664    1.696761
                  |
            state |
               1  |   1.563366   .6298717     1.11   0.267     .7097677     3.44354
               2  |   2.466787    .236197     9.43   0.000     2.044694    2.976014
               3  |   .6421469   .2393833    -1.19   0.235     .3092562    1.333369
               4  |   1.924295   .6022806     2.09   0.036     1.041972    3.553753
               5  |   .8063506   .2255844    -0.77   0.442     .4660066    1.395262
               6  |   .7200015   .0653904    -3.62   0.000     .6025976    .8602791
               7  |   .8117539   .2638806    -0.64   0.521     .4292599    1.535071
               8  |   1.381297    .148992     2.99   0.003     1.118081    1.706479
               9  |   2.421099   .3919171     5.46   0.000     1.762884    3.325075
              10  |    .620934   .2329709    -1.27   0.204     .2976319    1.295422
              11  |     .60738   .1584256    -1.91   0.056      .364282    1.012706
              12  |   1.061597   .1831945     0.35   0.729     .7569583    1.488837
              13  |   2.022515   .7556493     1.89   0.059     .9724492    4.206457
              14  |   .6712008   .2056053    -1.30   0.193      .368221    1.223479
              15  |   .5614371   .0604583    -5.36   0.000     .4546107    .6933662
              17  |          1  (empty)
                  |
             time |
            2000  |   .9847297   .1377106    -0.11   0.912     .7486518    1.295252
            2002  |   .7520118   .1114457    -1.92   0.054      .562444    1.005472
            2003  |   .8123038    .136254    -1.24   0.215     .5847092    1.128488
            2004  |   .5368143   .0861718    -3.88   0.000     .3919093    .7352967
            2005  |   .5441159   .0816017    -4.06   0.000     .4055419    .7300408
            2006  |   .5859412   .0895304    -3.50   0.000     .4343027    .7905248
            2007  |   .5557476   .0902137    -3.62   0.000     .4042996    .7639271
            2008  |   .4411191   .0717461    -5.03   0.000     .3207093    .6067365
            2009  |   .2186245   .0384837    -8.64   0.000     .1548335    .3086972
            2010  |   .3072475   .0564877    -6.42   0.000     .2142863    .4405371
            2011  |   .3811282   .0682097    -5.39   0.000     .2683696    .5412636
            2012  |   .3374806   .0649167    -5.65   0.000     .2314805    .4920206
            2013  |   .2358504   .0493309    -6.91   0.000     .1565301    .3553657
            2014  |   .1901689    .042383    -7.45   0.000     .1228661    .2943384
            2015  |   .2554494   .0565093    -6.17   0.000     .1655793    .3940976
                  |
            _cons |   .0000221   2.83e-06   -83.49   0.000     .0000172    .0000284
          lnhours |          1  (offset)
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.B.V.1.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.V.1.csv not foun
> d)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.V.1.csv)

. 
. pause "next"

. 
. // diagnostics/assessment
. lfit

Logistic model for dv_indicator, goodness-of-fit test

       number of observations =      6242
 number of covariate patterns =      6227
           Pearson chi2(6187) =      5929.80
                  Prob > chi2 =         0.9903

. 
. pause "next"

. 
. linktest

Iteration 0:   log likelihood = -4293.1367  
Iteration 1:   log likelihood = -2899.5714  
Iteration 2:   log likelihood = -2892.2608  
Iteration 3:   log likelihood = -2892.0575  
Iteration 4:   log likelihood =  -2892.057  
Iteration 5:   log likelihood =  -2892.057  

Logistic regression                             Number of obs     =      6,242
                                                LR chi2(2)        =    2802.16
                                                Prob > chi2       =     0.0000
Log likelihood =  -2892.057                     Pseudo R2         =     0.3264

------------------------------------------------------------------------------
dv_indicator |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        _hat |   1.120454   .0319154    35.11   0.000     1.057901    1.183007
      _hatsq |  -.0305561   .0151379    -2.02   0.044    -.0602258   -.0008864
       _cons |   .0260153   .0363052     0.72   0.474    -.0451415    .0971722
------------------------------------------------------------------------------

. 
. pause "next"

. 
. estat classification

Logistic model for dv_indicator

              -------- True --------
Classified |         D            ~D  |      Total
-----------+--------------------------+-----------
     +     |      2762           744  |       3506
     -     |       682          2054  |       2736
-----------+--------------------------+-----------
   Total   |      3444          2798  |       6242

Classified + if predicted Pr(D) >= .5
True D defined as dv_indicator != 0
--------------------------------------------------
Sensitivity                     Pr( +| D)   80.20%
Specificity                     Pr( -|~D)   73.41%
Positive predictive value       Pr( D| +)   78.78%
Negative predictive value       Pr(~D| -)   75.07%
--------------------------------------------------
False + rate for true ~D        Pr( +|~D)   26.59%
False - rate for true D         Pr( -| D)   19.80%
False + rate for classified +   Pr(~D| +)   21.22%
False - rate for classified -   Pr( D| -)   24.93%
--------------------------------------------------
Correctly classified                        77.15%
--------------------------------------------------

. 
. pause "next"

. 
. predict bv1_yhat 
(option pr assumed; Pr(dv_indicator))
(11 missing values generated)

. gen bv1_res = dv_indicator - bv1_yhat
(11 missing values generated)

. 
. summ dv_indicator bv1_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dv_indicator |      6,253    .5525348    .4972722          0          1
    bv1_yhat |      6,242    .5517462    .2922927   .0003764   .9999936

. /*
> pause "next"
> 
> scatter dv_indicator bv1_yhat
> 
> pause "next"
> 
> scatter bv1_res dv_indicator
> 
> pause "next"
> 
> scatter bv1_res bv1_yhat
> */
. pause "complete: B.V.1"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model B.V.2
. 
. eststo clear

. eststo: logit dv_indicator `count_lag_1_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) offset(lnhours) iter(50) or

note: 17.state != 0 predicts success perfectly
      17.state dropped and 11 obs not used

Iteration 0:   log pseudolikelihood = -3080.1072  
Iteration 1:   log pseudolikelihood = -2914.5595  
Iteration 2:   log pseudolikelihood = -2902.7542  
Iteration 3:   log pseudolikelihood = -2902.6335  
Iteration 4:   log pseudolikelihood = -2902.6335  

Logistic regression                             Number of obs     =      6,242
                                                Wald chi2(36)     =          .
Log pseudolikelihood = -2902.6335               Prob > chi2       =          .

                                  (Std. Err. adjusted for 1,237 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
     dv_indicator | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
         p47_1lag |   .9958347   .1319254    -0.03   0.975     .7681082    1.291077
         p48_1lag |   1.040859   .0401468     1.04   0.299     .9650734    1.122596
         p71_1lag |   1.347102   .2680734     1.50   0.134     .9120347     1.98971
         p72_1lag |     .98795   .1217416    -0.10   0.922      .775969     1.25784
         p75_1lag |   1.005161   .0014061     3.68   0.000     1.002409    1.007921
         p77_1lag |   1.035998   .0184346     1.99   0.047     1.000489    1.072766
        mine_time |   .9959974   .0139234    -0.29   0.774     .9690785    1.023664
onsite_insp_hours |   1.000788   .0001992     3.96   0.000     1.000398    1.001179
         longwall |   .9529701   .2802624    -0.16   0.870     .5354839    1.695947
                  |
            state |
               1  |   1.566797   .6349031     1.11   0.268     .7080859    3.466887
               2  |   2.524183   .2414866     9.68   0.000     2.092604    3.044771
               3  |   .6589205   .2414272    -1.14   0.255     .3213323    1.351175
               4  |    1.92013   .6007515     2.09   0.037     1.039956    3.545245
               5  |    .826033   .2261581    -0.70   0.485     .4830015    1.412688
               6  |   .7215953   .0654044    -3.60   0.000      .604146    .8618773
               7  |   .8297868   .2695505    -0.57   0.566      .438995     1.56846
               8  |   1.410644   .1544022     3.14   0.002      1.13828    1.748179
               9  |   2.486742   .4104224     5.52   0.000     1.799471    3.436502
              10  |   .6146518     .23146    -1.29   0.196     .2938268    1.285781
              11  |   .6148713   .1549717    -1.93   0.054     .3751872    1.007675
              12  |   1.049459   .1815898     0.28   0.780     .7476192    1.473162
              13  |   2.013572   .7454285     1.89   0.059     .9746542    4.159908
              14  |   .6943494   .2123827    -1.19   0.233     .3812576    1.264555
              15  |   .5706268   .0611968    -5.23   0.000     .4624503    .7041079
              17  |          1  (empty)
                  |
             time |
            2000  |   1.023737   .1435548     0.17   0.867     .7777282    1.347564
            2002  |   .7469008   .1105939    -1.97   0.049     .5587598    .9983911
            2003  |   .8124613   .1365307    -1.24   0.216     .5844694    1.129389
            2004  |   .5356158   .0859782    -3.89   0.000     .3910359    .7336519
            2005  |   .5525029   .0826347    -3.97   0.000     .4121215    .7407026
            2006  |   .5932536   .0906597    -3.42   0.001     .4397053    .8004221
            2007  |   .5721762   .0927749    -3.44   0.001     .4164017    .7862253
            2008  |   .4463641   .0728923    -4.94   0.000     .3241053    .6147413
            2009  |   .2215836   .0388994    -8.58   0.000     .1570752    .3125846
            2010  |   .3070588   .0564458    -6.42   0.000     .2141645    .4402464
            2011  |   .3812259   .0682144    -5.39   0.000     .2684561    .5413666
            2012  |   .3305179   .0636739    -5.75   0.000     .2265749    .4821455
            2013  |   .2320059   .0486596    -6.97   0.000     .1538059    .3499655
            2014  |   .1916401   .0426603    -7.42   0.000     .1238806    .2964622
            2015  |   .2493656   .0551804    -6.28   0.000     .1616143    .3847629
                  |
            _cons |   .0000221   2.84e-06   -83.62   0.000     .0000172    .0000285
          lnhours |          1  (offset)
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.B.V.2.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.V.2.csv not foun
> d)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.V.2.csv)

. 
. pause "next"

. 
. // diagnostics/assessment
. lfit

Logistic model for dv_indicator, goodness-of-fit test

       number of observations =      6242
 number of covariate patterns =      6226
           Pearson chi2(6186) =      6066.97
                  Prob > chi2 =         0.8579

. 
. pause "next"

. 
. linktest

Iteration 0:   log likelihood = -4293.1367  
Iteration 1:   log likelihood = -2900.8453  
Iteration 2:   log likelihood = -2894.1454  
Iteration 3:   log likelihood = -2893.9954  
Iteration 4:   log likelihood = -2893.9951  

Logistic regression                             Number of obs     =      6,242
                                                LR chi2(2)        =    2798.28
                                                Prob > chi2       =     0.0000
Log likelihood = -2893.9951                     Pseudo R2         =     0.3259

------------------------------------------------------------------------------
dv_indicator |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        _hat |   1.123354   .0320662    35.03   0.000     1.060505    1.186202
      _hatsq |   -.033371   .0150552    -2.22   0.027    -.0628787   -.0038634
       _cons |   .0287615   .0362237     0.79   0.427    -.0422356    .0997586
------------------------------------------------------------------------------

. 
. pause "next"

. 
. estat classification

Logistic model for dv_indicator

              -------- True --------
Classified |         D            ~D  |      Total
-----------+--------------------------+-----------
     +     |      2765           751  |       3516
     -     |       679          2047  |       2726
-----------+--------------------------+-----------
   Total   |      3444          2798  |       6242

Classified + if predicted Pr(D) >= .5
True D defined as dv_indicator != 0
--------------------------------------------------
Sensitivity                     Pr( +| D)   80.28%
Specificity                     Pr( -|~D)   73.16%
Positive predictive value       Pr( D| +)   78.64%
Negative predictive value       Pr(~D| -)   75.09%
--------------------------------------------------
False + rate for true ~D        Pr( +|~D)   26.84%
False - rate for true D         Pr( -| D)   19.72%
False + rate for classified +   Pr(~D| +)   21.36%
False - rate for classified -   Pr( D| -)   24.91%
--------------------------------------------------
Correctly classified                        77.09%
--------------------------------------------------

. 
. pause "next"

. 
. predict bv2_yhat 
(option pr assumed; Pr(dv_indicator))
(11 missing values generated)

. gen bv2_res = dv_indicator - bv2_yhat
(11 missing values generated)

. 
. summ dv_indicator bv2_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dv_indicator |      6,253    .5525348    .4972722          0          1
    bv2_yhat |      6,242    .5517462    .2919372   .0003704   .9999902

. /*
> pause "next"
> 
> scatter dv_indicator bv2_yhat
> 
> pause "next"
> 
> scatter bv2_res dv_indicator
> 
> pause "next"
> 
> scatter bv2_res bv2_yhat
> */
. pause "complete: B.V.2"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model B.V.3
. 
. eststo clear

. eststo: logit dv_indicator `count_lag_4_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) offset(lnhours) iter(50) or

note: 17.state != 0 predicts success perfectly
      17.state dropped and 11 obs not used

Iteration 0:   log pseudolikelihood = -3080.1072  
Iteration 1:   log pseudolikelihood = -2917.6994  
Iteration 2:   log pseudolikelihood = -2906.6234  
Iteration 3:   log pseudolikelihood = -2906.5203  
Iteration 4:   log pseudolikelihood = -2906.5202  

Logistic regression                             Number of obs     =      6,242
                                                Wald chi2(37)     =          .
Log pseudolikelihood = -2906.5202               Prob > chi2       =          .

                                  (Std. Err. adjusted for 1,237 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
     dv_indicator | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
       p47_c_4lag |   1.010711    .047576     0.23   0.821     .9216356    1.108395
       p48_c_4lag |   1.016751   .0129329     1.31   0.192     .9917159    1.042417
       p71_c_4lag |   1.064053    .070227     0.94   0.347     .9349409    1.210994
       p72_c_4lag |   1.007493   .0392259     0.19   0.848     .9334719    1.087384
       p75_c_4lag |   1.001025   .0003698     2.77   0.006     1.000301     1.00175
       p77_c_4lag |   1.010494   .0060363     1.75   0.081      .998732    1.022394
        mine_time |   .9918579   .0140128    -0.58   0.563     .9647701    1.019706
onsite_insp_hours |   1.000868   .0001996     4.35   0.000     1.000477    1.001259
         longwall |    .931678   .2746957    -0.24   0.810     .5227545    1.660481
                  |
            state |
               1  |   1.560933   .6306866     1.10   0.270     .7070677     3.44594
               2  |   2.570386   .2489638     9.75   0.000     2.125946    3.107738
               3  |   .6524616   .2360371    -1.18   0.238     .3210857    1.325834
               4  |   1.924803   .5983328     2.11   0.035     1.046615    3.539857
               5  |   .8137162   .2269265    -0.74   0.460     .4710778    1.405573
               6  |   .7203915    .065433    -3.61   0.000     .6029122    .8607619
               7  |    .832017   .2628892    -0.58   0.561     .4479003     1.54555
               8  |   1.382298   .1508524     2.97   0.003     1.116114    1.711964
               9  |    2.43704   .4059783     5.35   0.000     1.758182    3.378014
              10  |   .6055586   .2277795    -1.33   0.182     .2897201    1.265709
              11  |   .6290637   .1599676    -1.82   0.068     .3821541    1.035501
              12  |   1.023919   .1777272     0.14   0.892     .7286479    1.438842
              13  |   2.003637   .7371052     1.89   0.059     .9742628    4.120616
              14  |    .690569   .2148582    -1.19   0.234     .3752934    1.270701
              15  |   .5657086    .061207    -5.27   0.000     .4576114    .6993406
              17  |          1  (empty)
                  |
             time |
            2000  |   1.066959   .1509549     0.46   0.647     .8085717    1.407917
            2002  |   .7374649    .109269    -2.06   0.040     .5515948    .9859674
            2003  |   .8024371   .1346242    -1.31   0.190     .5775713     1.11485
            2004  |   .5327688   .0857471    -3.91   0.000     .3886343     .730359
            2005  |    .546318   .0821374    -4.02   0.000     .4068831    .7335359
            2006  |    .594162   .0912105    -3.39   0.001     .4397805     .802738
            2007  |   .5778822   .0937516    -3.38   0.001     .4204809    .7942045
            2008  |   .4547831   .0743908    -4.82   0.000     .3300424      .62667
            2009  |   .2249156   .0395743    -8.48   0.000     .1593123    .3175337
            2010  |   .3077531   .0566184    -6.41   0.000     .2145873    .4413681
            2011  |   .3784559   .0679346    -5.41   0.000     .2662078    .5380343
            2012  |   .3292529    .063495    -5.76   0.000     .2256208    .4804854
            2013  |   .2281078   .0478599    -7.04   0.000     .1511983    .3441384
            2014  |   .1893539   .0422083    -7.47   0.000     .1223307    .2930981
            2015  |    .246018   .0547661    -6.30   0.000     .1590307    .3805861
                  |
            _cons |    .000023   2.93e-06   -83.76   0.000     .0000179    .0000295
          lnhours |          1  (offset)
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.B.V.3.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.V.3.csv not foun
> d)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.V.3.csv)

. 
. pause "next"

. 
. // diagnostics/assessment
. lfit

Logistic model for dv_indicator, goodness-of-fit test

       number of observations =      6242
 number of covariate patterns =      6226
           Pearson chi2(6186) =      6045.98
                  Prob > chi2 =         0.8966

. 
. pause "next"

. 
. linktest

Iteration 0:   log likelihood = -4293.1367  
Iteration 1:   log likelihood =   -2905.19  
Iteration 2:   log likelihood = -2898.4008  
Iteration 3:   log likelihood = -2898.2715  
Iteration 4:   log likelihood = -2898.2714  

Logistic regression                             Number of obs     =      6,242
                                                LR chi2(2)        =    2789.73
                                                Prob > chi2       =     0.0000
Log likelihood = -2898.2714                     Pseudo R2         =     0.3249

------------------------------------------------------------------------------
dv_indicator |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        _hat |   1.120772   .0319281    35.10   0.000     1.058194    1.183349
      _hatsq |  -.0314707   .0151639    -2.08   0.038    -.0611914   -.0017499
       _cons |   .0264969   .0362788     0.73   0.465    -.0446083     .097602
------------------------------------------------------------------------------

. 
. pause "next"

. 
. estat classification

Logistic model for dv_indicator

              -------- True --------
Classified |         D            ~D  |      Total
-----------+--------------------------+-----------
     +     |      2771           748  |       3519
     -     |       673          2050  |       2723
-----------+--------------------------+-----------
   Total   |      3444          2798  |       6242

Classified + if predicted Pr(D) >= .5
True D defined as dv_indicator != 0
--------------------------------------------------
Sensitivity                     Pr( +| D)   80.46%
Specificity                     Pr( -|~D)   73.27%
Positive predictive value       Pr( D| +)   78.74%
Negative predictive value       Pr(~D| -)   75.28%
--------------------------------------------------
False + rate for true ~D        Pr( +|~D)   26.73%
False - rate for true D         Pr( -| D)   19.54%
False + rate for classified +   Pr(~D| +)   21.26%
False - rate for classified -   Pr( D| -)   24.72%
--------------------------------------------------
Correctly classified                        77.23%
--------------------------------------------------

. 
. pause "next"

. 
. predict bv3_yhat 
(option pr assumed; Pr(dv_indicator))
(11 missing values generated)

. gen bv3_res = dv_indicator - bv3_yhat
(11 missing values generated)

. 
. summ dv_indicator bv3_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dv_indicator |      6,253    .5525348    .4972722          0          1
    bv3_yhat |      6,242    .5517462    .2917238   .0003772   .9999841

. /*
> pause "next"
> 
> scatter dv_indicator bv3_yhat
> 
> pause "next"
> 
> scatter bv3_res dv_indicator
> 
> pause "next"
> 
> scatter bv3_res bv3_yhat
> */
. pause "complete: B.V.3"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model B.V.4
. 
. eststo clear

. eststo: logit dv_indicator `count_lag_all_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) offset(lnhours) iter(50) or

note: 17.state != 0 predicts success perfectly
      17.state dropped and 11 obs not used

Iteration 0:   log pseudolikelihood = -3080.1072  
Iteration 1:   log pseudolikelihood = -2923.0291  
Iteration 2:   log pseudolikelihood = -2911.9285  
Iteration 3:   log pseudolikelihood = -2911.7615  
Iteration 4:   log pseudolikelihood = -2911.7615  

Logistic regression                             Number of obs     =      6,242
                                                Wald chi2(36)     =          .
Log pseudolikelihood = -2911.7615               Prob > chi2       =          .

                                  (Std. Err. adjusted for 1,237 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
     dv_indicator | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
    p47_c_lag_all |   .9779437   .0237325    -0.92   0.358     .9325176    1.025583
    p48_c_lag_all |   1.003806   .0060273     0.63   0.527     .9920623    1.015689
    p71_c_lag_all |   1.076564    .039074     2.03   0.042     1.002641    1.155938
    p72_c_lag_all |   .9983393   .0143348    -0.12   0.908     .9706354    1.026834
    p75_c_lag_all |   1.000007   .0000453     0.15   0.879     .9999181    1.000096
    p77_c_lag_all |   1.001986   .0024313     0.82   0.414     .9972321    1.006763
        mine_time |   .9869646   .0150721    -0.86   0.390     .9578616    1.016952
onsite_insp_hours |   1.001257   .0001768     7.11   0.000      1.00091    1.001603
         longwall |    .864235   .2603205    -0.48   0.628     .4788917    1.559648
                  |
            state |
               1  |   1.592835   .6403206     1.16   0.247     .7244148    3.502308
               2  |   2.853558   .2886762    10.37   0.000     2.340324    3.479344
               3  |   .6194698   .2693612    -1.10   0.271     .2641776    1.452594
               4  |   1.877669   .5629907     2.10   0.036     1.043276    3.379395
               5  |   .7810431    .218114    -0.88   0.376     .4518232    1.350148
               6  |    .714672   .0647097    -3.71   0.000     .5984598    .8534508
               7  |   .9550417   .2626579    -0.17   0.867     .5570867    1.637276
               8  |    1.37462   .1475098     2.97   0.003     1.113886    1.696386
               9  |   2.439154   .4139827     5.25   0.000      1.74892    3.401798
              10  |   .5904733   .2231544    -1.39   0.163     .2815206    1.238484
              11  |   .6579672   .1822615    -1.51   0.131     .3823098    1.132382
              12  |   .9335186   .1608732    -0.40   0.690     .6659405    1.308611
              13  |   2.044821   .7670345     1.91   0.057      .980303    4.265306
              14  |   .6861346   .2198492    -1.18   0.240     .3661591    1.285727
              15  |   .5897298   .0627989    -4.96   0.000     .4786418    .7266002
              17  |          1  (empty)
                  |
             time |
            2000  |   .9792251     .13521    -0.15   0.879     .7470503    1.283557
            2002  |   .7313441   .1072792    -2.13   0.033     .5486064    .9749506
            2003  |   .7881504   .1307725    -1.43   0.151     .5693443    1.091046
            2004  |   .5218608   .0835508    -4.06   0.000      .381308    .7142225
            2005  |   .5318532   .0786742    -4.27   0.000     .3979955    .7107312
            2006  |   .5895779   .0896065    -3.48   0.001     .4376955    .7941643
            2007  |   .5880681   .0946907    -3.30   0.001      .428911     .806284
            2008  |   .4683388   .0761348    -4.67   0.000     .3405539    .6440719
            2009  |   .2357749   .0414639    -8.22   0.000     .1670334    .3328065
            2010  |   .3163968   .0582556    -6.25   0.000       .22055    .4538967
            2011  |   .3837856   .0693934    -5.30   0.000     .2692653    .5470122
            2012  |   .3247811    .062793    -5.82   0.000     .2223412    .4744185
            2013  |   .2148695   .0449904    -7.34   0.000     .1425432    .3238943
            2014  |   .1725179   .0382153    -7.93   0.000     .1117584    .2663105
            2015  |   .2240587   .0508382    -6.59   0.000      .143624    .3495398
                  |
            _cons |   .0000242   3.10e-06   -83.12   0.000     .0000189    .0000311
          lnhours |          1  (offset)
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.B.V.4.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.V.4.csv not foun
> d)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.V.4.csv)

. 
. pause "next"

. 
. // diagnostics/assessment
. lfit

Logistic model for dv_indicator, goodness-of-fit test

       number of observations =      6242
 number of covariate patterns =      6227
           Pearson chi2(6187) =      6224.89
                  Prob > chi2 =         0.3647

. 
. pause "next"

. 
. linktest

Iteration 0:   log likelihood = -4293.1367  
Iteration 1:   log likelihood = -2909.2739  
Iteration 2:   log likelihood = -2903.2943  
Iteration 3:   log likelihood = -2903.0358  
Iteration 4:   log likelihood = -2903.0352  
Iteration 5:   log likelihood = -2903.0352  

Logistic regression                             Number of obs     =      6,242
                                                LR chi2(2)        =    2780.20
                                                Prob > chi2       =     0.0000
Log likelihood = -2903.0352                     Pseudo R2         =     0.3238

------------------------------------------------------------------------------
dv_indicator |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        _hat |   1.123838   .0320471    35.07   0.000     1.061027     1.18665
      _hatsq |  -.0335682   .0151801    -2.21   0.027    -.0633206   -.0038158
       _cons |   .0277519   .0361968     0.77   0.443    -.0431926    .0986964
------------------------------------------------------------------------------

. 
. pause "next"

. 
. estat classification

Logistic model for dv_indicator

              -------- True --------
Classified |         D            ~D  |      Total
-----------+--------------------------+-----------
     +     |      2769           753  |       3522
     -     |       675          2045  |       2720
-----------+--------------------------+-----------
   Total   |      3444          2798  |       6242

Classified + if predicted Pr(D) >= .5
True D defined as dv_indicator != 0
--------------------------------------------------
Sensitivity                     Pr( +| D)   80.40%
Specificity                     Pr( -|~D)   73.09%
Positive predictive value       Pr( D| +)   78.62%
Negative predictive value       Pr(~D| -)   75.18%
--------------------------------------------------
False + rate for true ~D        Pr( +|~D)   26.91%
False - rate for true D         Pr( -| D)   19.60%
False + rate for classified +   Pr(~D| +)   21.38%
False - rate for classified -   Pr( D| -)   24.82%
--------------------------------------------------
Correctly classified                        77.12%
--------------------------------------------------

. 
. pause "next"

. 
. predict bv4_yhat 
(option pr assumed; Pr(dv_indicator))
(11 missing values generated)

. gen bv4_res = dv_indicator - bv4_yhat
(11 missing values generated)

. 
. summ dv_indicator bv4_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dv_indicator |      6,253    .5525348    .4972722          0          1
    bv4_yhat |      6,242    .5517462    .2909576   .0003732    .999995

. /*
> pause "next"
> 
> scatter dv_indicator bv4_yhat
> 
> pause "next"
> 
> scatter bv4_res dv_indicator
> 
> pause "next"
> 
> scatter bv4_res bv4_yhat
> */
. pause "complete: B.V.4"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model B.SSV.1
. 
. eststo clear

. eststo: logit dv_indicator `ss_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) offset(lnhours) iter(50) or

note: 17.state != 0 predicts success perfectly
      17.state dropped and 11 obs not used

Iteration 0:   log pseudolikelihood = -3080.1072  
Iteration 1:   log pseudolikelihood =   -2914.67  
Iteration 2:   log pseudolikelihood = -2903.8524  
Iteration 3:   log pseudolikelihood = -2903.7457  
Iteration 4:   log pseudolikelihood = -2903.7457  

Logistic regression                             Number of obs     =      6,242
                                                Wald chi2(36)     =          .
Log pseudolikelihood = -2903.7457               Prob > chi2       =          .

                                  (Std. Err. adjusted for 1,237 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
     dv_indicator | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
           p47_ss |   .6354022   .3292732    -0.88   0.382     .2301154    1.754493
           p48_ss |   1.171714   .1326573     1.40   0.162     .9385378    1.462823
           p71_ss |   .9387449   .3661403    -0.16   0.871     .4370711    2.016244
           p72_ss |   1.712634   .7250636     1.27   0.204     .7469619    3.926727
           p75_ss |   1.012013   .0030991     3.90   0.000     1.005957    1.018105
           p77_ss |   1.099262   .0621406     1.67   0.094     .9839734    1.228059
        mine_time |    .998737   .0138134    -0.09   0.927      .972027    1.026181
onsite_insp_hours |    1.00102   .0001774     5.75   0.000     1.000672    1.001368
         longwall |   .9829884   .2884454    -0.06   0.953     .5530624    1.747119
                  |
            state |
               1  |   1.544021   .5996179     1.12   0.263     .7212579    3.305338
               2  |   2.475844   .2292741     9.79   0.000     2.064896    2.968577
               3  |   .7961159   .2808821    -0.65   0.518     .3987118    1.589621
               4  |   1.930308   .5935007     2.14   0.032     1.056605    3.526474
               5  |   .8216485   .2254924    -0.72   0.474     .4798254    1.406983
               6  |    .706359   .0641178    -3.83   0.000     .5912349    .8438999
               7  |   .8731219   .2660063    -0.45   0.656     .4805591    1.586364
               8  |   1.439396   .1446524     3.62   0.000     1.182057    1.752758
               9  |   2.663248   .4361896     5.98   0.000     1.931973    3.671321
              10  |   .5903579   .2216621    -1.40   0.160     .2828226    1.232301
              11  |   .6126829   .1722956    -1.74   0.081     .3530735    1.063179
              12  |   .9988739   .1725349    -0.01   0.995     .7120051    1.401323
              13  |   2.007766    .741738     1.89   0.059     .9733075    4.141678
              14  |   .6371953    .195048    -1.47   0.141     .3497167    1.160991
              15  |   .5728517   .0611207    -5.22   0.000     .4647536    .7060925
              17  |          1  (empty)
                  |
             time |
            2000  |   .9763378   .1372054    -0.17   0.865     .7412765    1.285938
            2002  |   .7513245   .1119087    -1.92   0.055     .5611026    1.006034
            2003  |   .8051666   .1357475    -1.29   0.199      .578598    1.120455
            2004  |   .5236879    .084696    -4.00   0.000     .3814239    .7190139
            2005  |   .5332451   .0800874    -4.19   0.000     .3972701    .7157606
            2006  |   .5713849   .0877043    -3.65   0.000     .4229356    .7719396
            2007  |   .5677043   .0923625    -3.48   0.001     .4127016     .780923
            2008  |   .4624843   .0752444    -4.74   0.000     .3362094     .636186
            2009  |   .2427249   .0424894    -8.09   0.000     .1722305    .3420729
            2010  |   .3192206   .0583746    -6.24   0.000     .2230669    .4568218
            2011  |   .3962622   .0713106    -5.14   0.000     .2784852    .5638496
            2012  |   .3535665   .0681922    -5.39   0.000     .2422704    .5159907
            2013  |    .245479   .0520613    -6.62   0.000     .1619911    .3719953
            2014  |   .1976805   .0443482    -7.23   0.000     .1273512    .3068491
            2015  |    .258977   .0576258    -6.07   0.000     .1674394    .4005572
                  |
            _cons |   .0000218   2.78e-06   -84.18   0.000      .000017     .000028
          lnhours |          1  (offset)
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.B.SSV.1.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.SSV.1.csv not fo
> und)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.SSV.1.csv
> )

. 
. pause "next"

. 
. // diagnostics/assessment
. lfit

Logistic model for dv_indicator, goodness-of-fit test

       number of observations =      6242
 number of covariate patterns =      6226
           Pearson chi2(6186) =      5779.17
                  Prob > chi2 =         0.9999

. 
. pause "next"

. 
. linktest

Iteration 0:   log likelihood = -4293.1367  
Iteration 1:   log likelihood = -2904.2185  
Iteration 2:   log likelihood = -2896.4348  
Iteration 3:   log likelihood = -2896.2709  
Iteration 4:   log likelihood = -2896.2707  

Logistic regression                             Number of obs     =      6,242
                                                LR chi2(2)        =    2793.73
                                                Prob > chi2       =     0.0000
Log likelihood = -2896.2707                     Pseudo R2         =     0.3254

------------------------------------------------------------------------------
dv_indicator |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        _hat |   1.115977   .0316916    35.21   0.000     1.053862    1.178091
      _hatsq |  -.0264973   .0153368    -1.73   0.084    -.0565569    .0035623
       _cons |   .0215547   .0364332     0.59   0.554    -.0498531    .0929625
------------------------------------------------------------------------------

. 
. pause "next"

. 
. estat classification

Logistic model for dv_indicator

              -------- True --------
Classified |         D            ~D  |      Total
-----------+--------------------------+-----------
     +     |      2766           740  |       3506
     -     |       678          2058  |       2736
-----------+--------------------------+-----------
   Total   |      3444          2798  |       6242

Classified + if predicted Pr(D) >= .5
True D defined as dv_indicator != 0
--------------------------------------------------
Sensitivity                     Pr( +| D)   80.31%
Specificity                     Pr( -|~D)   73.55%
Positive predictive value       Pr( D| +)   78.89%
Negative predictive value       Pr(~D| -)   75.22%
--------------------------------------------------
False + rate for true ~D        Pr( +|~D)   26.45%
False - rate for true D         Pr( -| D)   19.69%
False + rate for classified +   Pr(~D| +)   21.11%
False - rate for classified -   Pr( D| -)   24.78%
--------------------------------------------------
Correctly classified                        77.28%
--------------------------------------------------

. 
. pause "next"

. 
. predict bssv1_yhat 
(option pr assumed; Pr(dv_indicator))
(11 missing values generated)

. gen bssv1_res = dv_indicator - bssv1_yhat
(11 missing values generated)

. 
. summ dv_indicator bssv1_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dv_indicator |      6,253    .5525348    .4972722          0          1
  bssv1_yhat |      6,242    .5517462     .292231   .0003875   .9999785

. /*
> pause "next"
> 
> scatter dv_indicator bssv1_yhat
> 
> pause "next"
> 
> scatter bssv1_res dv_indicator
> 
> pause "next"
> 
> scatter bssv1_res bssv1_yhat
> */
. pause "complete: B.SSV.1"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model B.SSV.2
. 
. eststo clear

. eststo: logit dv_indicator `ss_lag_1_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) offset(lnhours) iter(50) or

note: 17.state != 0 predicts success perfectly
      17.state dropped and 11 obs not used

Iteration 0:   log pseudolikelihood = -3080.1072  
Iteration 1:   log pseudolikelihood = -2914.2247  
Iteration 2:   log pseudolikelihood = -2903.2743  
Iteration 3:   log pseudolikelihood = -2903.1667  
Iteration 4:   log pseudolikelihood = -2903.1666  

Logistic regression                             Number of obs     =      6,242
                                                Wald chi2(36)     =          .
Log pseudolikelihood = -2903.1666               Prob > chi2       =          .

                                  (Std. Err. adjusted for 1,237 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
     dv_indicator | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
      p47_ss_1lag |   .7260105   .3088768    -0.75   0.452     .3153584    1.671404
      p48_ss_1lag |   1.117918   .1219923     1.02   0.307     .9026578    1.384513
      p71_ss_1lag |   1.463191    .831496     0.67   0.503     .4803791    4.456749
      p72_ss_1lag |   1.462498   .5876649     0.95   0.344     .6653696    3.214603
      p75_ss_1lag |   1.012564   .0031106     4.06   0.000     1.006486    1.018679
      p77_ss_1lag |   1.117349   .0686496     1.81   0.071     .9905838    1.260336
        mine_time |   .9969366   .0138133    -0.22   0.825     .9702273    1.024381
onsite_insp_hours |   1.001021   .0001775     5.76   0.000     1.000673    1.001369
         longwall |   .9889477    .291377    -0.04   0.970     .5551124    1.761837
                  |
            state |
               1  |   1.555347   .6081133     1.13   0.259     .7228072    3.346818
               2  |   2.477391   .2318104     9.70   0.000     2.062278    2.976061
               3  |   .7966131    .279291    -0.65   0.517     .4006986    1.583715
               4  |   1.925014    .589855     2.14   0.033     1.055874    3.509583
               5  |   .8312064   .2292877    -0.67   0.503      .484067     1.42729
               6  |   .7069297    .064121    -3.82   0.000     .5917921     .844468
               7  |   .8684839   .2636333    -0.46   0.642     .4790432    1.574523
               8  |   1.447004     .14528     3.68   0.000     1.188526    1.761696
               9  |   2.661186   .4412589     5.90   0.000     1.922805    3.683116
              10  |   .5925768   .2227697    -1.39   0.164     .2836281    1.238055
              11  |   .6136744   .1702312    -1.76   0.078     .3563014     1.05696
              12  |   1.003737   .1737128     0.02   0.983     .7149997    1.409075
              13  |   1.968541   .7184512     1.86   0.063      .962686    4.025357
              14  |   .6461457   .1957026    -1.44   0.149     .3568792    1.169876
              15  |   .5726632   .0611169    -5.22   0.000     .4645748    .7058994
              17  |          1  (empty)
                  |
             time |
            2000  |   1.021689   .1437442     0.15   0.879     .7754629    1.346098
            2002  |   .7532989   .1119462    -1.91   0.057     .5629529    1.008005
            2003  |   .8106925   .1369835    -1.24   0.214     .5821405    1.128975
            2004  |   .5269567    .085294    -3.96   0.000     .3837055    .7236886
            2005  |   .5404069   .0808601    -4.11   0.000     .4030483    .7245772
            2006  |   .5801779   .0891449    -3.54   0.000     .4293122    .7840597
            2007  |    .575202   .0939357    -3.39   0.001     .4176489      .79219
            2008  |   .4657192   .0763548    -4.66   0.000     .3377299    .6422127
            2009  |   .2415982    .042452    -8.08   0.000     .1712089    .3409268
            2010  |   .3236472   .0592622    -6.16   0.000     .2260531    .4633756
            2011  |   .3953918   .0713382    -5.14   0.000     .2776199    .5631251
            2012  |   .3491883   .0676732    -5.43   0.000     .2388337    .5105329
            2013  |   .2474562   .0524793    -6.59   0.000     .1632977    .3749876
            2014  |   .1997631   .0449174    -7.16   0.000     .1285641    .3103921
            2015  |   .2614099   .0584064    -6.00   0.000     .1687094    .4050463
                  |
            _cons |   .0000216   2.77e-06   -83.95   0.000     .0000168    .0000278
          lnhours |          1  (offset)
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.B.SSV.2.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.SSV.2.csv not fo
> und)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.SSV.2.csv
> )

. 
. pause "next"

. 
. // diagnostics/assessment
. lfit

Logistic model for dv_indicator, goodness-of-fit test

       number of observations =      6242
 number of covariate patterns =      6226
           Pearson chi2(6186) =      5952.61
                  Prob > chi2 =         0.9830

. 
. pause "next"

. 
. linktest

Iteration 0:   log likelihood = -4293.1367  
Iteration 1:   log likelihood = -2902.2593  
Iteration 2:   log likelihood = -2895.2764  
Iteration 3:   log likelihood = -2895.1514  
Iteration 4:   log likelihood = -2895.1513  

Logistic regression                             Number of obs     =      6,242
                                                LR chi2(2)        =    2795.97
                                                Prob > chi2       =     0.0000
Log likelihood = -2895.1513                     Pseudo R2         =     0.3256

------------------------------------------------------------------------------
dv_indicator |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        _hat |   1.118727   .0318433    35.13   0.000     1.056315    1.181138
      _hatsq |   -.031021   .0151225    -2.05   0.040    -.0606606   -.0013813
       _cons |   .0264694   .0363279     0.73   0.466     -.044732    .0976708
------------------------------------------------------------------------------

. 
. pause "next"

. 
. estat classification

Logistic model for dv_indicator

              -------- True --------
Classified |         D            ~D  |      Total
-----------+--------------------------+-----------
     +     |      2777           738  |       3515
     -     |       667          2060  |       2727
-----------+--------------------------+-----------
   Total   |      3444          2798  |       6242

Classified + if predicted Pr(D) >= .5
True D defined as dv_indicator != 0
--------------------------------------------------
Sensitivity                     Pr( +| D)   80.63%
Specificity                     Pr( -|~D)   73.62%
Positive predictive value       Pr( D| +)   79.00%
Negative predictive value       Pr(~D| -)   75.54%
--------------------------------------------------
False + rate for true ~D        Pr( +|~D)   26.38%
False - rate for true D         Pr( -| D)   19.37%
False + rate for classified +   Pr(~D| +)   21.00%
False - rate for classified -   Pr( D| -)   24.46%
--------------------------------------------------
Correctly classified                        77.49%
--------------------------------------------------

. 
. pause "next"

. 
. predict bssv2_yhat 
(option pr assumed; Pr(dv_indicator))
(11 missing values generated)

. gen bssv2_res = dv_indicator - bssv2_yhat
(11 missing values generated)

. 
. summ dv_indicator bssv2_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dv_indicator |      6,253    .5525348    .4972722          0          1
  bssv2_yhat |      6,242    .5517462    .2922822   .0003872   .9999679

. /*
> pause "next"
> 
> scatter dv_indicator bssv2_yhat
> 
> pause "next"
> 
> scatter bssv2_res dv_indicator
> 
> pause "next"
> 
> scatter bssv2_res bssv2_yhat
> */
. pause "complete: B.SSV.2"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model B.SSV.3
. 
. eststo clear

. eststo: logit dv_indicator `ss_lag_4_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) offset(lnhours) iter(50) or

note: 17.state != 0 predicts success perfectly
      17.state dropped and 11 obs not used

Iteration 0:   log pseudolikelihood = -3080.1072  
Iteration 1:   log pseudolikelihood = -2915.9122  
Iteration 2:   log pseudolikelihood = -2905.0476  
Iteration 3:   log pseudolikelihood = -2904.9402  
Iteration 4:   log pseudolikelihood = -2904.9402  

Logistic regression                             Number of obs     =      6,242
                                                Wald chi2(36)     =          .
Log pseudolikelihood = -2904.9402               Prob > chi2       =          .

                                  (Std. Err. adjusted for 1,237 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
     dv_indicator | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
    p47_ss_c_4lag |   .8511086   .1572351    -0.87   0.383     .5925605    1.222467
    p48_ss_c_4lag |   1.020657   .0400185     0.52   0.602     .9451602    1.102184
    p71_ss_c_4lag |   1.060624   .1817599     0.34   0.731     .7580374    1.483995
    p72_ss_c_4lag |   1.096603    .123993     0.82   0.415     .8786256    1.368658
    p75_ss_c_4lag |      1.003   .0008575     3.50   0.000     1.001321    1.004682
    p77_ss_c_4lag |   1.043212   .0214874     2.05   0.040     1.001936    1.086188
        mine_time |   .9937074   .0138576    -0.45   0.651     .9669148    1.021242
onsite_insp_hours |   1.001033   .0001781     5.80   0.000     1.000684    1.001382
         longwall |   .9728509   .2906538    -0.09   0.927     .5416728    1.747252
                  |
            state |
               1  |   1.537745   .6020557     1.10   0.272     .7138767    3.312421
               2  |   2.504771   .2398023     9.59   0.000      2.07623    3.021764
               3  |   .7908065   .2779832    -0.67   0.504     .3970608     1.57501
               4  |   1.918148   .5845553     2.14   0.033      1.05555    3.485665
               5  |   .8261973    .230048    -0.69   0.493     .4787112    1.425916
               6  |   .7092018   .0642781    -3.79   0.000     .5937746    .8470675
               7  |    .856834   .2596302    -0.51   0.610     .4731221    1.551744
               8  |   1.425959   .1458185     3.47   0.001      1.16698    1.742413
               9  |   2.584511   .4227259     5.81   0.000     1.875663    3.561246
              10  |   .5866177   .2211045    -1.42   0.157     .2802369    1.227962
              11  |   .6265174   .1742634    -1.68   0.093     .3632241    1.080666
              12  |   .9950729   .1722117    -0.03   0.977     .7088302    1.396907
              13  |   1.965281   .7112748     1.87   0.062     .9668467    3.994769
              14  |   .6550135    .203767    -1.36   0.174     .3560012    1.205172
              15  |   .5686756   .0609752    -5.26   0.000     .4608887    .7016704
              17  |          1  (empty)
                  |
             time |
            2000  |   1.074192   .1519582     0.51   0.613     .8140825    1.417409
            2002  |   .7439643   .1108488    -1.99   0.047     .5555526    .9962745
            2003  |   .8085949    .136386    -1.26   0.208     .5809764    1.125391
            2004  |   .5299811   .0858961    -3.92   0.000     .3857473     .728145
            2005  |   .5389737    .080885    -4.12   0.000     .4016298    .7232847
            2006  |   .5888821   .0907534    -3.44   0.001       .43536    .7965411
            2007  |   .5774426   .0942348    -3.37   0.001     .4193711    .7950953
            2008  |   .4698283   .0770571    -4.61   0.000      .340669    .6479565
            2009  |   .2421075   .0426682    -8.05   0.000     .1713939     .341996
            2010  |   .3250454   .0594509    -6.14   0.000     .2271219    .4651885
            2011  |   .3941748   .0711901    -5.15   0.000      .276667    .5615914
            2012  |   .3477038   .0673109    -5.46   0.000     .2379184    .5081488
            2013  |   .2452355   .0519176    -6.64   0.000     .1619495    .3713531
            2014  |   .1995275   .0448129    -7.18   0.000     .1284774    .3098693
            2015  |   .2617273   .0585178    -6.00   0.000     .1688631    .4056611
                  |
            _cons |   .0000221   2.82e-06   -84.06   0.000     .0000172    .0000284
          lnhours |          1  (offset)
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.B.SSV.3.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.SSV.3.csv not fo
> und)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.SSV.3.csv
> )

. 
. pause "next"

. 
. // diagnostics/assessment
. lfit

Logistic model for dv_indicator, goodness-of-fit test

       number of observations =      6242
 number of covariate patterns =      6226
           Pearson chi2(6186) =      5921.61
                  Prob > chi2 =         0.9919

. 
. pause "next"

. 
. linktest

Iteration 0:   log likelihood = -4293.1367  
Iteration 1:   log likelihood = -2904.1896  
Iteration 2:   log likelihood =  -2897.146  
Iteration 3:   log likelihood = -2897.0231  
Iteration 4:   log likelihood =  -2897.023  

Logistic regression                             Number of obs     =      6,242
                                                LR chi2(2)        =    2792.23
                                                Prob > chi2       =     0.0000
Log likelihood =  -2897.023                     Pseudo R2         =     0.3252

------------------------------------------------------------------------------
dv_indicator |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        _hat |   1.118201   .0318192    35.14   0.000     1.055836    1.180565
      _hatsq |  -.0303522   .0151614    -2.00   0.045     -.060068   -.0006364
       _cons |   .0256096   .0363317     0.70   0.481    -.0455992    .0968183
------------------------------------------------------------------------------

. 
. pause "next"

. 
. estat classification

Logistic model for dv_indicator

              -------- True --------
Classified |         D            ~D  |      Total
-----------+--------------------------+-----------
     +     |      2768           746  |       3514
     -     |       676          2052  |       2728
-----------+--------------------------+-----------
   Total   |      3444          2798  |       6242

Classified + if predicted Pr(D) >= .5
True D defined as dv_indicator != 0
--------------------------------------------------
Sensitivity                     Pr( +| D)   80.37%
Specificity                     Pr( -|~D)   73.34%
Positive predictive value       Pr( D| +)   78.77%
Negative predictive value       Pr(~D| -)   75.22%
--------------------------------------------------
False + rate for true ~D        Pr( +|~D)   26.66%
False - rate for true D         Pr( -| D)   19.63%
False + rate for classified +   Pr(~D| +)   21.23%
False - rate for classified -   Pr( D| -)   24.78%
--------------------------------------------------
Correctly classified                        77.22%
--------------------------------------------------

. 
. pause "next"

. 
. predict bssv3_yhat 
(option pr assumed; Pr(dv_indicator))
(11 missing values generated)

. gen bssv3_res = dv_indicator - bssv3_yhat
(11 missing values generated)

. 
. summ dv_indicator bssv3_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dv_indicator |      6,253    .5525348    .4972722          0          1
  bssv3_yhat |      6,242    .5517462    .2921187   .0003914   .9999579

. /*
> pause "next"
> 
> scatter dv_indicator bssv3_yhat
> 
> pause "next"
> 
> scatter bssv3_res dv_indicator
> 
> pause "next"
> 
> scatter bssv3_res bssv3_yhat
> */
. pause "complete: B.SSV.3"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model B.SSV.4
. 
. eststo clear

. eststo: logit dv_indicator `ss_lag_all_vars' `covariates' ib(freq).state ib(freq).time, vce(cl mineid) offset(lnhours) iter(50) or

note: 17.state != 0 predicts success perfectly
      17.state dropped and 11 obs not used

Iteration 0:   log pseudolikelihood = -3080.1072  
Iteration 1:   log pseudolikelihood = -2919.7629  
Iteration 2:   log pseudolikelihood = -2907.5064  
Iteration 3:   log pseudolikelihood = -2907.3591  
Iteration 4:   log pseudolikelihood = -2907.3591  

Logistic regression                             Number of obs     =      6,242
                                                Wald chi2(36)     =          .
Log pseudolikelihood = -2907.3591               Prob > chi2       =          .

                                  (Std. Err. adjusted for 1,237 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
     dv_indicator | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
 p47_ss_c_lag_all |   .9641726   .0731361    -0.48   0.631      .830975    1.118721
 p48_ss_c_lag_all |   1.006049   .0148879     0.41   0.684     .9772879    1.035656
 p71_ss_c_lag_all |   1.103735   .1008623     1.08   0.280     .9227404    1.320231
 p72_ss_c_lag_all |   .9486527   .0310221    -1.61   0.107     .8897581    1.011446
 p75_ss_c_lag_all |   1.000079   .0001386     0.57   0.570     .9998071    1.000351
 p77_ss_c_lag_all |   1.022247   .0085666     2.63   0.009     1.005594    1.039176
        mine_time |   .9867846   .0152176    -0.86   0.388     .9574049    1.017066
onsite_insp_hours |   1.001222   .0001751     6.98   0.000     1.000878    1.001565
         longwall |   .9399716   .3187555    -0.18   0.855     .4835732    1.827121
                  |
            state |
               1  |   1.570037   .6380329     1.11   0.267     .7079425    3.481945
               2  |   2.902675    .288798    10.71   0.000     2.388412    3.527667
               3  |   .7175606   .2751066    -0.87   0.387     .3384661    1.521255
               4  |   1.810644    .549111     1.96   0.050     .9992876    3.280768
               5  |   .7968861   .2209356    -0.82   0.413      .462809    1.372116
               6  |   .7160216   .0649608    -3.68   0.000     .5993785    .8553642
               7  |   .9664066   .2452338    -0.13   0.893     .5877063     1.58913
               8  |   1.385678   .1552387     2.91   0.004     1.112503    1.725929
               9  |   2.786268   .4729255     6.04   0.000     1.997767    3.885985
              10  |   .5821117   .2206465    -1.43   0.153     .2769253    1.223629
              11  |    .630298   .1558722    -1.87   0.062     .3881901    1.023405
              12  |   .9656134   .1681993    -0.20   0.841     .6863305    1.358543
              13  |   2.062953   .7718402     1.94   0.053     .9908731    4.294976
              14  |   .7554721   .2483196    -0.85   0.394     .3966734    1.438811
              15  |   .5887694    .062295    -5.01   0.000     .4785018    .7244475
              17  |          1  (empty)
                  |
             time |
            2000  |   .9783041   .1353249    -0.16   0.874     .7459857    1.282972
            2002  |   .7265866   .1068889    -2.17   0.030     .5445857    .9694124
            2003  |   .7808426   .1298529    -1.49   0.137     .5636506    1.081725
            2004  |    .516543   .0830052    -4.11   0.000     .3769847    .7077651
            2005  |   .5257774   .0779363    -4.34   0.000     .3932129    .7030337
            2006  |    .586327   .0893059    -3.51   0.000     .4350006    .7902963
            2007  |   .5820403   .0935775    -3.37   0.001     .4247185    .7976364
            2008  |   .4650679   .0756985    -4.70   0.000     .3380394    .6398311
            2009  |   .2342161   .0414053    -8.21   0.000       .16563    .3312031
            2010  |   .3148329   .0576365    -6.31   0.000     .2199128    .4507229
            2011  |   .3823651   .0691697    -5.31   0.000      .268223    .5450801
            2012  |   .3258508   .0630389    -5.80   0.000     .2230211    .4760929
            2013  |   .2192392   .0461835    -7.20   0.000     .1450807    .3313041
            2014  |   .1761782    .039396    -7.76   0.000     .1136609     .273082
            2015  |   .2305913   .0518926    -6.52   0.000     .1483499    .3584252
                  |
            _cons |    .000024   3.07e-06   -83.35   0.000     .0000187    .0000308
          lnhours |          1  (offset)
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.B.SSV.4.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.SSV.4.csv not fo
> und)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.SSV.4.csv
> )

. 
. pause "next"

. 
. // diagnostics/assessment
. lfit

Logistic model for dv_indicator, goodness-of-fit test

       number of observations =      6242
 number of covariate patterns =      6226
           Pearson chi2(6186) =      6218.39
                  Prob > chi2 =         0.3834

. 
. pause "next"

. 
. linktest

Iteration 0:   log likelihood = -4293.1367  
Iteration 1:   log likelihood =  -2904.024  
Iteration 2:   log likelihood =  -2898.345  
Iteration 3:   log likelihood = -2898.1521  
Iteration 4:   log likelihood = -2898.1515  
Iteration 5:   log likelihood = -2898.1515  

Logistic regression                             Number of obs     =      6,242
                                                LR chi2(2)        =    2789.97
                                                Prob > chi2       =     0.0000
Log likelihood = -2898.1515                     Pseudo R2         =     0.3249

------------------------------------------------------------------------------
dv_indicator |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        _hat |   1.126165   .0322308    34.94   0.000     1.062993    1.189336
      _hatsq |  -.0365412   .0148875    -2.45   0.014    -.0657201   -.0073623
       _cons |   .0310796   .0360409     0.86   0.389    -.0395594    .1017185
------------------------------------------------------------------------------

. 
. pause "next"

. 
. estat classification

Logistic model for dv_indicator

              -------- True --------
Classified |         D            ~D  |      Total
-----------+--------------------------+-----------
     +     |      2787           756  |       3543
     -     |       657          2042  |       2699
-----------+--------------------------+-----------
   Total   |      3444          2798  |       6242

Classified + if predicted Pr(D) >= .5
True D defined as dv_indicator != 0
--------------------------------------------------
Sensitivity                     Pr( +| D)   80.92%
Specificity                     Pr( -|~D)   72.98%
Positive predictive value       Pr( D| +)   78.66%
Negative predictive value       Pr(~D| -)   75.66%
--------------------------------------------------
False + rate for true ~D        Pr( +|~D)   27.02%
False - rate for true D         Pr( -| D)   19.08%
False + rate for classified +   Pr(~D| +)   21.34%
False - rate for classified -   Pr( D| -)   24.34%
--------------------------------------------------
Correctly classified                        77.36%
--------------------------------------------------

. 
. pause "next"

. 
. predict bssv4_yhat 
(option pr assumed; Pr(dv_indicator))
(11 missing values generated)

. gen bssv4_res = dv_indicator - bssv4_yhat
(11 missing values generated)

. 
. summ dv_indicator bssv4_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dv_indicator |      6,253    .5525348    .4972722          0          1
  bssv4_yhat |      6,242    .5517462    .2912874   .0003774   .9999923

. /*
> pause "next"
> 
> scatter dv_indicator bssv4_yhat
> 
> pause "next"
> 
> scatter bssv4_res dv_indicator
> 
> pause "next"
> 
> scatter bssv4_res bssv4_yhat
> */
. pause "complete: B.SSV.4"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model B.PP.1
. 
. eststo clear

. eststo: logit dv_indicator `pp_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, vce(cl mineid) offset(lnhours) iter(50) or

note: 9.state != 0 predicts success perfectly
      9.state dropped and 9 obs not used

note: 17.state != 0 predicts success perfectly
      17.state dropped and 9 obs not used

Iteration 0:   log pseudolikelihood = -1600.2972  
Iteration 1:   log pseudolikelihood = -1521.8831  
Iteration 2:   log pseudolikelihood = -1517.8248  
Iteration 3:   log pseudolikelihood =  -1517.796  
Iteration 4:   log pseudolikelihood =  -1517.796  

Logistic regression                             Number of obs     =      3,315
                                                Wald chi2(29)     =          .
Log pseudolikelihood =  -1517.796               Prob > chi2       =          .

                                    (Std. Err. adjusted for 725 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
     dv_indicator | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
           p47_pp |   .9968226   .0024981    -1.27   0.204     .9919384    1.001731
           p48_pp |   1.001526   .0010169     1.50   0.133     .9995347    1.003521
           p71_pp |   1.003523   .0035946     0.98   0.326     .9965029    1.010593
           p72_pp |   1.001861   .0026635     0.70   0.484     .9966538    1.007095
           p75_pp |    1.00005   .0000211     2.37   0.018     1.000009    1.000091
           p77_pp |   1.000462   .0003608     1.28   0.200     .9997554     1.00117
        mine_time |   .9993336    .014628    -0.05   0.964     .9710706    1.028419
onsite_insp_hours |   1.000541   .0002051     2.64   0.008     1.000139    1.000943
         longwall |   1.030617   .3808493     0.08   0.935     .4995151    2.126406
                  |
            state |
               1  |   1.618712   .7346569     1.06   0.289     .6650423    3.939941
               2  |    3.98446   .5383502    10.23   0.000     3.057466    5.192511
               3  |   .6538732   .3547206    -0.78   0.434     .2258001     1.89349
               4  |    2.32729   .6700266     2.93   0.003       1.3237    4.091771
               5  |   1.013795   .3594277     0.04   0.969     .5060199    2.031105
               6  |   .8898081   .1136226    -0.91   0.361     .6927932     1.14285
               7  |   1.347852   .3501616     1.15   0.251     .8100399    2.242734
               8  |    .518122   .1711493    -1.99   0.047     .2711801    .9899341
               9  |          1  (empty)
              10  |    .530785   .2088259    -1.61   0.107     .2454888     1.14764
              11  |    .486685   .2117611    -1.66   0.098     .2074351    1.141862
              12  |   1.028198    .243145     0.12   0.906     .6468258    1.634429
              13  |   1.904708   1.062515     1.16   0.248     .6382601    5.684068
              14  |   .7716977   .3388569    -0.59   0.555     .3263471    1.824797
              15  |   .6113297   .0891851    -3.37   0.001     .4592997    .8136823
              17  |          1  (empty)
                  |
             time |
            2007  |   1.259768    .196326     1.48   0.138     .9281896    1.709796
            2009  |    .517207   .0808562    -4.22   0.000     .3807097     .702643
            2010  |   .7219879   .1204983    -1.95   0.051     .5205544    1.001368
            2011  |   .8662303   .1313756    -0.95   0.344     .6434831    1.166083
            2012  |   .7656277   .1341237    -1.52   0.127      .543129    1.079275
            2013  |   .5411258   .1028974    -3.23   0.001      .372768    .7855211
            2014  |   .4533052   .0907836    -3.95   0.000     .3061401    .6712144
            2015  |   .6077662   .1166987    -2.59   0.010     .4171529    .8854783
                  |
            _cons |   .0000109   1.70e-06   -73.31   0.000     8.03e-06    .0000148
          lnhours |          1  (offset)
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.B.PP.1.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.PP.1.csv not fou
> nd)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.PP.1.csv)

. 
. pause "next"

. 
. // diagnostics/assessment
. lfit

Logistic model for dv_indicator, goodness-of-fit test

       number of observations =      3315
 number of covariate patterns =      3315
           Pearson chi2(3283) =      3034.29
                  Prob > chi2 =         0.9992

. 
. pause "next"

. 
. linktest

Iteration 0:   log likelihood =  -2282.022  
Iteration 1:   log likelihood = -1518.1103  
Iteration 2:   log likelihood = -1514.9131  
Iteration 3:   log likelihood = -1514.8767  
Iteration 4:   log likelihood = -1514.8766  

Logistic regression                             Number of obs     =      3,315
                                                LR chi2(2)        =    1534.29
                                                Prob > chi2       =     0.0000
Log likelihood = -1514.8766                     Pseudo R2         =     0.3362

------------------------------------------------------------------------------
dv_indicator |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        _hat |   1.091797   .0414293    26.35   0.000     1.010597    1.172997
      _hatsq |  -.0267062   .0200325    -1.33   0.182    -.0659691    .0125566
       _cons |   .0268275   .0511664     0.52   0.600    -.0734567    .1271118
------------------------------------------------------------------------------

. 
. pause "next"

. 
. estat classification

Logistic model for dv_indicator

              -------- True --------
Classified |         D            ~D  |      Total
-----------+--------------------------+-----------
     +     |      1475           386  |       1861
     -     |       344          1110  |       1454
-----------+--------------------------+-----------
   Total   |      1819          1496  |       3315

Classified + if predicted Pr(D) >= .5
True D defined as dv_indicator != 0
--------------------------------------------------
Sensitivity                     Pr( +| D)   81.09%
Specificity                     Pr( -|~D)   74.20%
Positive predictive value       Pr( D| +)   79.26%
Negative predictive value       Pr(~D| -)   76.34%
--------------------------------------------------
False + rate for true ~D        Pr( +|~D)   25.80%
False - rate for true D         Pr( -| D)   18.91%
False + rate for classified +   Pr(~D| +)   20.74%
False - rate for classified -   Pr( D| -)   23.66%
--------------------------------------------------
Correctly classified                        77.98%
--------------------------------------------------

. 
. pause "next"

. 
. predict bpp1_yhat 
(option pr assumed; Pr(dv_indicator))
(27 missing values generated)

. gen bpp1_res = dv_indicator - bpp1_yhat
(27 missing values generated)

. 
. summ dv_indicator bpp1_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dv_indicator |      6,253    .5525348    .4972722          0          1
   bpp1_yhat |      6,226    .5064068    .2860673   .0004259   .9999506

. /*
> pause "next"
> 
> scatter dv_indicator bpp1_yhat
> 
> pause "next"
> 
> scatter bpp1_res dv_indicator
> 
> pause "next"
> 
> scatter bpp1_res bpp1_yhat
> */
. pause "complete: B.PP.1"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model B.PP.2
. 
. eststo clear

. eststo: logit dv_indicator `pp_lag_1_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, vce(cl mineid) offset(lnhours) iter(50) or

note: 9.state != 0 predicts success perfectly
      9.state dropped and 9 obs not used

note: 17.state != 0 predicts success perfectly
      17.state dropped and 9 obs not used

Iteration 0:   log pseudolikelihood = -1600.2972  
Iteration 1:   log pseudolikelihood = -1524.0215  
Iteration 2:   log pseudolikelihood = -1520.1928  
Iteration 3:   log pseudolikelihood =  -1520.163  
Iteration 4:   log pseudolikelihood =  -1520.163  

Logistic regression                             Number of obs     =      3,315
                                                Wald chi2(29)     =          .
Log pseudolikelihood =  -1520.163               Prob > chi2       =          .

                                    (Std. Err. adjusted for 725 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
     dv_indicator | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
      p47_pp_1lag |   .9985643   .0022883    -0.63   0.531     .9940894    1.003059
      p48_pp_1lag |   1.001118   .0008857     1.26   0.207     .9993832    1.002855
      p71_pp_1lag |   1.002902   .0037592     0.77   0.439      .995561    1.010297
      p72_pp_1lag |    .999307   .0024775    -0.28   0.780      .994463    1.004175
      p75_pp_1lag |   1.000041   .0000204     2.00   0.045     1.000001    1.000081
      p77_pp_1lag |   1.000531   .0003711     1.43   0.152     .9998038    1.001259
        mine_time |   .9974151   .0147124    -0.18   0.861     .9689922    1.026672
onsite_insp_hours |   1.000637   .0002044     3.12   0.002     1.000237    1.001038
         longwall |    1.02641   .3758546     0.07   0.943     .5007541    2.103861
                  |
            state |
               1  |   1.617585   .7377108     1.05   0.292     .6617148    3.954244
               2  |   4.077019   .5480965    10.45   0.000     3.132644    5.306089
               3  |   .6666932   .3579357    -0.76   0.450     .2327722    1.909506
               4  |   2.304805    .667629     2.88   0.004     1.306376    4.066308
               5  |   1.020707   .3591158     0.06   0.954     .5121801    2.034135
               6  |   .8855257   .1127573    -0.95   0.340      .689945    1.136548
               7  |   1.360393     .34269     1.22   0.222     .8303141    2.228879
               8  |   .5309439    .171261    -1.96   0.050     .2821536    .9991064
               9  |          1  (empty)
              10  |   .5216997   .2057362    -1.65   0.099      .240848    1.130052
              11  |   .4973418   .2123908    -1.64   0.102     .2153514    1.148583
              12  |   1.000193   .2374534     0.00   0.999     .6280616    1.592816
              13  |    1.92499   1.060885     1.19   0.235     .6536136    5.669384
              14  |   .8090444   .3510534    -0.49   0.625      .345642    1.893731
              15  |   .6222079   .0905674    -3.26   0.001     .4677741    .8276273
              17  |          1  (empty)
                  |
             time |
            2007  |   1.296304   .2041787     1.65   0.099     .9519972    1.765136
            2009  |   .5154131   .0807685    -4.23   0.000     .3791114    .7007192
            2010  |   .7127462   .1192559    -2.02   0.043     .5134674     .989366
            2011  |     .85579   .1292354    -1.03   0.302     .6365386    1.150561
            2012  |   .7396932   .1286704    -1.73   0.083     .5259982    1.040205
            2013  |   .5237102   .0995091    -3.40   0.001     .3608743     .760022
            2014  |   .4430619   .0878444    -4.11   0.000     .3003997    .6534756
            2015  |   .5851667   .1119699    -2.80   0.005     .4021655    .8514408
                  |
            _cons |   .0000111   1.73e-06   -73.07   0.000     8.17e-06    .0000151
          lnhours |          1  (offset)
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.B.PP.2.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.PP.2.csv not fou
> nd)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.PP.2.csv)

. 
. pause "next"

. 
. // diagnostics/assessment
. lfit

Logistic model for dv_indicator, goodness-of-fit test

       number of observations =      3315
 number of covariate patterns =      3315
           Pearson chi2(3283) =      3084.55
                  Prob > chi2 =         0.9936

. 
. pause "next"

. 
. linktest

Iteration 0:   log likelihood =  -2282.022  
Iteration 1:   log likelihood = -1520.0248  
Iteration 2:   log likelihood = -1517.0934  
Iteration 3:   log likelihood =  -1517.064  
Iteration 4:   log likelihood =  -1517.064  

Logistic regression                             Number of obs     =      3,315
                                                LR chi2(2)        =    1529.92
                                                Prob > chi2       =     0.0000
Log likelihood =  -1517.064                     Pseudo R2         =     0.3352

------------------------------------------------------------------------------
dv_indicator |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        _hat |   1.094636   .0416106    26.31   0.000     1.013081    1.176192
      _hatsq |  -.0281101   .0201089    -1.40   0.162    -.0675228    .0113026
       _cons |   .0279343   .0510866     0.55   0.585    -.0721936    .1280622
------------------------------------------------------------------------------

. 
. pause "next"

. 
. estat classification

Logistic model for dv_indicator

              -------- True --------
Classified |         D            ~D  |      Total
-----------+--------------------------+-----------
     +     |      1467           392  |       1859
     -     |       352          1104  |       1456
-----------+--------------------------+-----------
   Total   |      1819          1496  |       3315

Classified + if predicted Pr(D) >= .5
True D defined as dv_indicator != 0
--------------------------------------------------
Sensitivity                     Pr( +| D)   80.65%
Specificity                     Pr( -|~D)   73.80%
Positive predictive value       Pr( D| +)   78.91%
Negative predictive value       Pr(~D| -)   75.82%
--------------------------------------------------
False + rate for true ~D        Pr( +|~D)   26.20%
False - rate for true D         Pr( -| D)   19.35%
False + rate for classified +   Pr(~D| +)   21.09%
False - rate for classified -   Pr( D| -)   24.18%
--------------------------------------------------
Correctly classified                        77.56%
--------------------------------------------------

. 
. pause "next"

. 
. predict bpp2_yhat 
(option pr assumed; Pr(dv_indicator))
(27 missing values generated)

. gen bpp2_res = dv_indicator - bpp2_yhat
(27 missing values generated)

. 
. summ dv_indicator bpp2_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dv_indicator |      6,253    .5525348    .4972722          0          1
   bpp2_yhat |      6,226    .5092706    .2858163   .0004191   .9999301

. /*
> pause "next"
> 
> scatter dv_indicator bpp2_yhat
> 
> pause "next"
> 
> scatter bpp2_res dv_indicator
> 
> pause "next"
> 
> scatter bpp2_res bpp2_yhat
> */
. pause "complete: B.PP.2"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model B.PP.3
. 
. eststo clear

. eststo: logit dv_indicator `pp_lag_4_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, vce(cl mineid) offset(lnhours) iter(50) or

note: 9.state != 0 predicts success perfectly
      9.state dropped and 9 obs not used

note: 17.state != 0 predicts success perfectly
      17.state dropped and 9 obs not used

Iteration 0:   log pseudolikelihood = -1600.2972  
Iteration 1:   log pseudolikelihood = -1524.7682  
Iteration 2:   log pseudolikelihood = -1521.0141  
Iteration 3:   log pseudolikelihood =  -1520.986  
Iteration 4:   log pseudolikelihood =  -1520.986  

Logistic regression                             Number of obs     =      3,315
                                                Wald chi2(29)     =          .
Log pseudolikelihood =  -1520.986               Prob > chi2       =          .

                                    (Std. Err. adjusted for 725 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
     dv_indicator | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
    p47_pp_c_4lag |   .9995612   .0007926    -0.55   0.580     .9980089    1.001116
    p48_pp_c_4lag |   1.000507   .0002951     1.72   0.086     .9999284    1.001085
    p71_pp_c_4lag |   1.000449   .0011738     0.38   0.702     .9981515    1.002753
    p72_pp_c_4lag |   .9999511   .0007785    -0.06   0.950     .9984264    1.001478
    p75_pp_c_4lag |   1.000007   5.43e-06     1.38   0.167     .9999969    1.000018
    p77_pp_c_4lag |   1.000143   .0001218     1.18   0.239     .9999047    1.000382
        mine_time |   .9963665   .0148321    -0.24   0.807     .9677161    1.025865
onsite_insp_hours |   1.000688   .0002077     3.31   0.001     1.000281    1.001095
         longwall |   1.014686   .3690615     0.04   0.968     .4974308    2.069811
                  |
            state |
               1  |   1.605875   .7341053     1.04   0.300      .655535     3.93394
               2  |   4.152009   .5650974    10.46   0.000     3.179859    5.421365
               3  |   .6486462   .3489631    -0.80   0.421     .2259814    1.861843
               4  |   2.317967   .6642242     2.93   0.003     1.321878    4.064649
               5  |   1.020368   .3650027     0.06   0.955     .5061366    2.057055
               6  |   .8817071   .1123319    -0.99   0.323      .686877      1.1318
               7  |   1.384582   .3387937     1.33   0.184     .8571129    2.236657
               8  |   .5149578   .1730747    -1.97   0.048     .2664938    .9950758
               9  |          1  (empty)
              10  |    .520901   .2055817    -1.65   0.098      .240334    1.129003
              11  |   .5035571   .2143138    -1.61   0.107     .2186641    1.159631
              12  |   .9813806   .2345879    -0.08   0.937     .6142814    1.567861
              13  |    1.92014   1.047011     1.20   0.232     .6594641    5.590812
              14  |   .7926566   .3543255    -0.52   0.603     .3300573    1.903622
              15  |   .6207038   .0907995    -3.26   0.001     .4659793    .8268034
              17  |          1  (empty)
                  |
             time |
            2007  |   1.286289   .2027655     1.60   0.110     .9444054    1.751937
            2009  |   .5147824   .0806923    -4.24   0.000     .3786148    .6999224
            2010  |   .7057286   .1181646    -2.08   0.037     .5082948    .9798505
            2011  |    .840114   .1267856    -1.15   0.248      .624999    1.129268
            2012  |   .7287214   .1260943    -1.83   0.067     .5191274    1.022938
            2013  |   .5102837    .096755    -3.55   0.000     .3518967      .73996
            2014  |   .4324819   .0861014    -4.21   0.000     .2927554     .638897
            2015  |   .5699739   .1092874    -2.93   0.003     .3914215    .8299756
                  |
            _cons |   .0000114   1.77e-06   -73.50   0.000     8.43e-06    .0000155
          lnhours |          1  (offset)
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.B.PP.3.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.PP.3.csv not fou
> nd)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.PP.3.csv)

. 
. pause "next"

. 
. // diagnostics/assessment
. lfit

Logistic model for dv_indicator, goodness-of-fit test

       number of observations =      3315
 number of covariate patterns =      3315
           Pearson chi2(3283) =      3062.47
                  Prob > chi2 =         0.9973

. 
. pause "next"

. 
. linktest

Iteration 0:   log likelihood =  -2282.022  
Iteration 1:   log likelihood = -1521.2283  
Iteration 2:   log likelihood = -1518.1288  
Iteration 3:   log likelihood = -1518.0939  
Iteration 4:   log likelihood = -1518.0939  

Logistic regression                             Number of obs     =      3,315
                                                LR chi2(2)        =    1527.86
                                                Prob > chi2       =     0.0000
Log likelihood = -1518.0939                     Pseudo R2         =     0.3348

------------------------------------------------------------------------------
dv_indicator |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        _hat |   1.092364   .0414187    26.37   0.000     1.011185    1.173544
      _hatsq |  -.0252799   .0202606    -1.25   0.212    -.0649899    .0144301
       _cons |    .024418    .051199     0.48   0.633    -.0759302    .1247662
------------------------------------------------------------------------------

. 
. pause "next"

. 
. estat classification

Logistic model for dv_indicator

              -------- True --------
Classified |         D            ~D  |      Total
-----------+--------------------------+-----------
     +     |      1478           394  |       1872
     -     |       341          1102  |       1443
-----------+--------------------------+-----------
   Total   |      1819          1496  |       3315

Classified + if predicted Pr(D) >= .5
True D defined as dv_indicator != 0
--------------------------------------------------
Sensitivity                     Pr( +| D)   81.25%
Specificity                     Pr( -|~D)   73.66%
Positive predictive value       Pr( D| +)   78.95%
Negative predictive value       Pr(~D| -)   76.37%
--------------------------------------------------
False + rate for true ~D        Pr( +|~D)   26.34%
False - rate for true D         Pr( -| D)   18.75%
False + rate for classified +   Pr(~D| +)   21.05%
False - rate for classified -   Pr( D| -)   23.63%
--------------------------------------------------
Correctly classified                        77.83%
--------------------------------------------------

. 
. pause "next"

. 
. predict bpp3_yhat 
(option pr assumed; Pr(dv_indicator))
(27 missing values generated)

. gen bpp3_res = dv_indicator - bpp3_yhat
(27 missing values generated)

. 
. summ dv_indicator bpp3_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dv_indicator |      6,253    .5525348    .4972722          0          1
   bpp3_yhat |      6,226    .5118741    .2856235   .0004202   .9999058

. /*
> pause "next"
> 
> scatter dv_indicator bpp3_yhat
> 
> pause "next"
> 
> scatter bpp3_res dv_indicator
> 
> pause "next"
> 
> scatter bpp3_res bpp3_yhat
> */
. pause "complete: B.PP.3"

. 
. ********************************************************************************
. ********************************************************************************
. 
. // Model B.PP.4
. 
. eststo clear

. eststo: logit dv_indicator `pp_lag_all_vars' `covariates' ib(freq).state ib(freq).time if sample_pp == 1, vce(cl mineid) offset(lnhours) iter(50) or

note: 9.state != 0 predicts success perfectly
      9.state dropped and 9 obs not used

note: 17.state != 0 predicts success perfectly
      17.state dropped and 9 obs not used

Iteration 0:   log pseudolikelihood = -1600.2972  
Iteration 1:   log pseudolikelihood = -1524.9398  
Iteration 2:   log pseudolikelihood = -1520.0748  
Iteration 3:   log pseudolikelihood = -1520.0284  
Iteration 4:   log pseudolikelihood = -1520.0283  

Logistic regression                             Number of obs     =      3,315
                                                Wald chi2(29)     =          .
Log pseudolikelihood = -1520.0283               Prob > chi2       =          .

                                    (Std. Err. adjusted for 725 clusters in mineid)
-----------------------------------------------------------------------------------
                  |               Robust
     dv_indicator | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
 p47_pp_c_lag_all |   .9994471    .000454    -1.22   0.223     .9985578    1.000337
 p48_pp_c_lag_all |   1.000096   .0001305     0.73   0.463     .9998402    1.000352
 p71_pp_c_lag_all |   1.001338   .0008204     1.63   0.103     .9997313    1.002947
 p72_pp_c_lag_all |   .9998982   .0002932    -0.35   0.728     .9993237    1.000473
 p75_pp_c_lag_all |   .9999998   8.47e-07    -0.20   0.845     .9999982    1.000001
 p77_pp_c_lag_all |   1.000084   .0000529     1.58   0.113     .9999801    1.000188
        mine_time |   .9949167   .0153609    -0.33   0.741     .9652609    1.025484
onsite_insp_hours |   1.000876   .0001769     4.96   0.000      1.00053    1.001223
         longwall |   .8939018   .3287877    -0.30   0.760     .4347181    1.838112
                  |
            state |
               1  |   1.580887   .7432585     0.97   0.330     .6290802     3.97279
               2  |   4.449452   .6309737    10.53   0.000     3.369754    5.875094
               3  |   .4638869   .2968581    -1.20   0.230     .1323419    1.626024
               4  |   2.303113   .6367063     3.02   0.003     1.339666    3.959441
               5  |   .9614541    .347749    -0.11   0.913     .4732132    1.953441
               6  |   .8632001   .1087359    -1.17   0.243     .6743525    1.104933
               7  |   1.453328   .3001442     1.81   0.070     .9695532    2.178489
               8  |   .5814483   .1842998    -1.71   0.087     .3123982    1.082215
               9  |          1  (empty)
              10  |    .508562   .2039944    -1.69   0.092     .2316914    1.116292
              11  |   .5143346   .2173021    -1.57   0.116     .2247089    1.177257
              12  |   .8813689    .209236    -0.53   0.595     .5534564    1.403564
              13  |   2.098365   1.165627     1.33   0.182       .70639    6.233292
              14  |   .8208305   .3716633    -0.44   0.663     .3379392     1.99374
              15  |   .6443687   .0925226    -3.06   0.002     .4863103    .8537985
              17  |          1  (empty)
                  |
             time |
            2007  |     1.2157   .1858153     1.28   0.201      .900997    1.640323
            2009  |    .516076   .0794581    -4.30   0.000     .3816433    .6978623
            2010  |   .6887919   .1149739    -2.23   0.026     .4965975    .9553698
            2011  |   .8116131   .1217209    -1.39   0.164     .6049102    1.088948
            2012  |   .6892032   .1202999    -2.13   0.033     .4895203    .9703397
            2013  |   .4653764   .0892571    -3.99   0.000     .3195565    .6777366
            2014  |   .3829548   .0750384    -4.90   0.000     .2608304    .5622596
            2015  |   .5006993   .0970986    -3.57   0.000     .3423788    .7322294
                  |
            _cons |   .0000123   1.95e-06   -71.26   0.000     8.98e-06    .0000167
          lnhours |          1  (offset)
-----------------------------------------------------------------------------------
(est1 stored)

. esttab using `"`directory'Model.`injury_label'.`time_label'.`violation_level_label'.B.PP.4.csv"', replace plain wide p eform
(note: file C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.PP.4.csv not fou
> nd)
(output written to C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/estout 10-22/Model.MR.Y.P.B.PP.4.csv)

. 
. pause "next"

. 
. // diagnostics/assessment
. lfit

Logistic model for dv_indicator, goodness-of-fit test

       number of observations =      3315
 number of covariate patterns =      3315
           Pearson chi2(3283) =      3115.06
                  Prob > chi2 =         0.9822

. 
. pause "next"

. 
. linktest

Iteration 0:   log likelihood =  -2282.022  
Iteration 1:   log likelihood = -1518.8872  
Iteration 2:   log likelihood = -1516.5341  
Iteration 3:   log likelihood = -1516.4987  
Iteration 4:   log likelihood = -1516.4986  

Logistic regression                             Number of obs     =      3,315
                                                LR chi2(2)        =    1531.05
                                                Prob > chi2       =     0.0000
Log likelihood = -1516.4986                     Pseudo R2         =     0.3355

------------------------------------------------------------------------------
dv_indicator |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        _hat |   1.100595   .0419785    26.22   0.000     1.018318    1.182871
      _hatsq |  -.0312013   .0200611    -1.56   0.120    -.0705204    .0081178
       _cons |    .030436   .0508534     0.60   0.550     -.069235    .1301069
------------------------------------------------------------------------------

. 
. pause "next"

. 
. estat classification

Logistic model for dv_indicator

              -------- True --------
Classified |         D            ~D  |      Total
-----------+--------------------------+-----------
     +     |      1473           398  |       1871
     -     |       346          1098  |       1444
-----------+--------------------------+-----------
   Total   |      1819          1496  |       3315

Classified + if predicted Pr(D) >= .5
True D defined as dv_indicator != 0
--------------------------------------------------
Sensitivity                     Pr( +| D)   80.98%
Specificity                     Pr( -|~D)   73.40%
Positive predictive value       Pr( D| +)   78.73%
Negative predictive value       Pr(~D| -)   76.04%
--------------------------------------------------
False + rate for true ~D        Pr( +|~D)   26.60%
False - rate for true D         Pr( -| D)   19.02%
False + rate for classified +   Pr(~D| +)   21.27%
False - rate for classified -   Pr( D| -)   23.96%
--------------------------------------------------
Correctly classified                        77.56%
--------------------------------------------------

. 
. pause "next"

. 
. predict bpp4_yhat 
(option pr assumed; Pr(dv_indicator))
(27 missing values generated)

. gen bpp4_res = dv_indicator - bpp4_yhat
(27 missing values generated)

. 
. summ dv_indicator bpp4_yhat

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dv_indicator |      6,253    .5525348    .4972722          0          1
   bpp4_yhat |      6,226    .5195568    .2847657   .0004112   .9999813

. /*
> pause "next"
> 
> scatter dv_indicator bpp4_yhat
> 
> pause "next"
> 
> scatter bpp4_res dv_indicator
> 
> pause "next"
> 
> scatter bpp4_res bpp4_yhat
> */
. pause "complete: B.PP.4"

. 
. ********************************************************************************
. ********************************************************************************
. 
. log close
      name:  <unnamed>
       log:  C:/Users/jbodson/Dropbox (Stanford Law School)/R-code/Injury-Classification/Model Output + Summaries/all/MR/log 10-22/log_part_year.txt
  log type:  text
 closed on:  22 Oct 2016, 12:23:31
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
